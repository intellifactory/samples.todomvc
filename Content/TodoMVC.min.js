function ignore(){}function id(n){return n}function fst(n){return n[0]}function snd(n){return n[1]}function trd(n){return n[2]}IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};IntelliFactory.Runtime.OnLoad(function(){self.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});console||(console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore});
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6;a=self;b=a.PrettyTodo=a.PrettyTodo||{};c=b.Client=b.Client||{};d=a.WebSharper=a.WebSharper||{};e=d.UI=d.UI||{};f=e.Client=e.Client||{};g=f.Templates=f.Templates||{};h=d.Obj=d.Obj||{};i=e.Doc=e.Doc||{};j=d.JavaScript=d.JavaScript||{};k=j.Pervasives=j.Pervasives||{};l=a.StartupCode$TodoMVC$Client=a.StartupCode$TodoMVC$Client||{};m=d.Operators=d.Operators||{};n=a.EventTarget;o=a.Node;p=j.JS=j.JS||{};q=d.Collections=d.Collections||{};r=q.Dictionary=q.Dictionary||{};s=e.DomUtility=e.DomUtility||{};t=d.Unchecked=d.Unchecked||{};u=e.RouteMap=e.RouteMap||{};v=c.Filter=c.Filter||{};w=d.List=d.List||{};x=w.T=w.T||{};y=e.ListModel=e.ListModel||{};z=c.TodoItem=c.TodoItem||{};A=e.Var$1=e.Var$1||{};B=e.AttrModule=e.AttrModule||{};C=e.Var=e.Var||{};D=e.Templating=e.Templating||{};E=D.Runtime=D.Runtime||{};F=E.Server=E.Server||{};G=F.TemplateInstance=F.TemplateInstance||{};H=d.Arrays=d.Arrays||{};I=F.ProviderBuilder=F.ProviderBuilder||{};J=F.Handler=F.Handler||{};K=e.View=e.View||{};L=a.TodoMVC_Templates=a.TodoMVC_Templates||{};M=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};N=q.HashSet=q.HashSet||{};O=d.Seq=d.Seq||{};P=a.WindowOrWorkerGlobalScope;Q=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};R=e.Docs=e.Docs||{};S=q.Map=q.Map||{};T=e.Storage=e.Storage||{};U=d.Numeric=d.Numeric||{};V=e.Routing=e.Routing||{};W=e.ConcreteVar=e.ConcreteVar||{};X=e.Snap=e.Snap||{};Y=q.List=q.List||{};Z=a.System=a.System||{};_0=Z.Guid=Z.Guid||{};_1=e.AttrProxy=e.AttrProxy||{};_2=e.Attrs=e.Attrs||{};_3=e.Array=e.Array||{};_4=E.Client=E.Client||{};_5=a.Event;_6=a.UIEvent;_7=d.Strings=d.Strings||{};_8=q.DictionaryUtil=q.DictionaryUtil||{};_9=a.Object;_=g.Prepare=g.Prepare||{};$=d.Slice=d.Slice||{};ba=d.Enumerator=d.Enumerator||{};bb=q.KeyCollection=q.KeyCollection||{};bc=e.DocElemNode=e.DocElemNode||{};bd=a.CharacterData;be=e.An=e.An||{};bf=f.Settings=f.Settings||{};bg=e.Abbrev=e.Abbrev||{};bh=bg.Mailbox=bg.Mailbox||{};bi=q.FSharpMap=q.FSharpMap||{};bj=T.ArrayStorage=T.ArrayStorage||{};bk=e.Route=e.Route||{};bl=bg.Fresh=bg.Fresh||{};bm=e.HtmlModule=e.HtmlModule||{};bn=bm.attr=bm.attr||{};bo=e.CheckedInput=e.CheckedInput||{};bp=ba.T=ba.T||{};bq=f.Attrs=f.Attrs||{};br=bq.Dyn=bq.Dyn||{};bs=f.Docs=f.Docs||{};bt=bs.RunState=bs.RunState||{};bu=bs.NodeSet=bs.NodeSet||{};bv=e.Anims=e.Anims||{};bw=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bx=q.MapUtil=q.MapUtil||{};by=e.AppendList=e.AppendList||{};bz=e.DynamicAttrNode=e.DynamicAttrNode||{};bA=e.Elt=e.Elt||{};bB=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bC=d.Concurrency=d.Concurrency||{};bD=q.BalancedTree=q.BalancedTree||{};bE=bD.Tree=bD.Tree||{};bF=q.Pair=q.Pair||{};bG=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bH=e.Updates=e.Updates||{};bI=q.HashSetUtil=q.HashSetUtil||{};bJ=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bK=e.Easing=e.Easing||{};bL=bC.AsyncBody=bC.AsyncBody||{};bM=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bN=bC.CT=bC.CT||{};bO=bg.HashSet=bg.HashSet||{};bP=d.Queue=d.Queue||{};bQ=bC.Scheduler=bC.Scheduler||{};bR=d.CancellationTokenSource=d.CancellationTokenSource||{};bS=bs.DomNodes=bs.DomNodes||{};bT=a.Error;bU=d.OperationCanceledException=d.OperationCanceledException||{};bV=d.Lazy=d.Lazy||{};bW=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};bX=e.String=e.String||{};bY=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};bZ=bY.LazyRecord=bY.LazyRecord||{};b0=d.Char=d.Char||{};b1=a.IntelliFactory;b2=b1&&b1.Runtime;b3=a.console;b4=a.jQuery;b5=a.Math;b6=a.Date;c.Main=function(){var b7;b7=c.TodoApp();g.LoadLocalTemplates("");i.RunById("main",b7);};c.TodoApp=function(){l.$cctor();return l.TodoApp;};c.Pages=function(){l.$cctor();return l.Pages;};c.notDoneItemsCount=function(b7){return K.Map(function(b8){return O.sumBy(function(b9){return b9.IsDone?0:1;},b8);},b7.v);};c.RenderList=function(b7,b8){return i.Flatten(b7.MapLens(function(b9,b_){return c.RenderTodo(b7,b8,b9,b_);}));};c.ShowIfNotEmpty=function(b7,b8){return i.EmbedView(K.Map(function(b9){return O.isEmpty(b9)?i.get_Empty():b8;},b7.v));};c.op_EqualsEqualsGreater=function(b7,b8){return _1.Create(b7,b8);};c.ToggleAllDone=function(b7){var b8;b8=b7.TryFind(function(b9){return!b9.IsDone;})!=null;b7.UpdateAll(function(b9){return{$:1,$0:z.New(b9.Id,b9.Text,b8,b9.IsEditing)};});};c.RemoveCompleted=function(b7){b7.RemoveBy(function(b8){return b8.IsDone;});};c.onEnter=function(b7,b8){if(b7.keyCode===13||b7.which===13)b8();};c.mkTodo=function(b7){return z.New(c.fresh(),b7,false,false);};c.hasAnyDoneItems=function(b7){function b8(b9){return b9.IsDone;}return K.Map(function(b9){return O.exists(b8,b9);},b7.v);};c.RenderTodo=function(b7,b8,b9,b_){var b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj;function ck(co){if(co==="")b7.RemoveByKey(b9);else b_.Update(function(cp){return z.New(cp.Id,co,cp.IsDone,false);});}function cl(co,cp,cq){c.onEnter(co,function(){ck(cq);});return c.onEscape(co,function(){ck(cp);});}function cm(){b_.Update(function(co){A.Set(b$,co.Text);return z.New(co.Id,co.Text,co.IsDone,true);});}function cn(co,cp){return cp.$==1?!co.IsDone:cp.$==2?co.IsDone:true;}b$=A.Create$1("");ca=i.Input([_1.Create("class","edit"),B.HandlerView("keydown",b_.get_View(),b2.Curried3(function(co,cp,cq){return cl(cp,cq.Text,b$.Get());})),B.HandlerView("blur",b_.get_View(),b2.Curried3(function(co,cp,cq){return ck(cq.Text);})),B.OnAfterRender(function(co){co.focus();})],b$);cb=(cc=(cd=A.Lens(b_,function(co){return co.IsDone;},function(co,cp){return z.New(co.Id,co.Text,cp,co.IsEditing);}),(ce=(cf=(cg=K.Map(function(co){return co.Text;},b_.get_View()),(ch=K.Map(function(co){return _7.concat(" ",w.ofSeq(O.delay(function(){return O.append(co.IsEditing?["editing"]:[],O.delay(function(){return co.IsDone?["completed"]:[];}));})));},b_.get_View()),I.Make().WithHole({$:2,$0:"itemstate",$1:ch})).WithHole({$:2,$0:"title",$1:cg})),cf.WithHole(J.EventQ2(cf.k,"destroy",function(){return cf.i;},function(){b7.RemoveByKey(b9);}))),ce.WithHole(J.EventQ2(ce.k,"edit",function(){return ce.i;},function(){cm();}))).WithHole({$:9,$0:"checked",$1:cd})).WithHole({$:0,$0:"titleediting",$1:ca}),(ci=J.CompleteHoles(cc.k,cc.h,[["checked",2]]),(cj=new G.New(ci[1],L.listitem(ci[0])),(cc.i=cj,cj)))).get_Doc();return i.EmbedView(K.Map2(function(co,cp){return cn(co,cp)?cb:i.get_Empty();},b_.get_View(),b8));};c.fresh=function(){var b7;b7=c.runningId();c.set_runningId(c.runningId()+1);return b7;};c.onEscape=function(b7,b8){if(b7.keyCode===27||b7.which===27)b8();};c.set_runningId=function(b7){l.$cctor();l.runningId=b7;};c.runningId=function(){l.$cctor();return l.runningId;};g.LoadLocalTemplates=function(b7){!g.LocalTemplatesLoaded()?(g.set_LocalTemplatesLoaded(true),g.LoadNestedTemplates(self.document.body,"")):void 0;g.LoadedTemplates().set_Item(b7,g.LoadedTemplateFile(""));};g.LocalTemplatesLoaded=function(){M.$cctor();return M.LocalTemplatesLoaded;};g.set_LocalTemplatesLoaded=function(b7){M.$cctor();M.LocalTemplatesLoaded=b7;};g.LoadNestedTemplates=function(b7,b8){var b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl;function b9(cm){var cn,co;if(!b_.ContainsKey(cm)){cn=(co=null,[b$.TryGetValue(cm,{get:function(){return co;},set:function(cp){co=cp;}}),co]);cn[0]?(cl.Add(cm),b$.Remove(cm),g.PrepareTemplateStrict(b8,{$:1,$0:cm},cn[1][0],{$:1,$0:cn[1][1]},{$:1,$0:b9})):b3.warn(cl.Contains(cm)?"Encountered loop when instantiating "+cm:"Local template does not exist: "+cm);}}b_=g.LoadedTemplateFile(b8);b$=new r.New$5();ca=b7.querySelectorAll("[ws-template]");for(cb=0,cc=ca.length-1;cb<=cc;cb++){cd=ca[cb];ce=cd.getAttribute("ws-template").toLowerCase();cd.removeAttribute("ws-template");b$.set_Item(ce,[[cd],g.FakeRootSingle(cd)]);}cf=b7.querySelectorAll("[ws-children-template]");for(cg=0,ch=cf.length-1;cg<=ch;cg++){ci=cf[cg];cj=ci.getAttribute("ws-children-template").toLowerCase();ci.removeAttribute("ws-children-template");b$.set_Item(cj,(ck=s.ChildrenArray(ci),[ck,g.FakeRoot(ck)]));}cl=new N.New$3();while(b$.count>0)b9(O.head(b$.get_Keys()));};g.LoadedTemplates=function(){M.$cctor();return M.LoadedTemplates;};g.LoadedTemplateFile=function(b7){var b8,b9,b_;b8=(b9=null,[g.LoadedTemplates().TryGetValue(b7,{get:function(){return b9;},set:function(b$){b9=b$;}}),b9]);return b8[0]?b8[1]:(b_=new r.New$5(),(g.LoadedTemplates().set_Item(b7,b_),b_));};g.FakeRootSingle=function(b7){var b8,b9,b_;b7.removeAttribute("ws-template");b8=b7.getAttribute("ws-replace");b8===null?void 0:(b7.removeAttribute("ws-replace"),b9=b7.parentNode,t.Equals(b9,null)?void 0:(b_=self.document.createElement(b7.tagName),b_.setAttribute("ws-replace",b8),b9.replaceChild(b_,b7)));return g.FakeRoot([b7]);};g.FakeRoot=function(b7){var b8,b9,b_;b8=self.document.createElement("div");for(b9=0,b_=b7.length-1;b9<=b_;b9++)b8.appendChild(H.get(b7,b9));return b8;};g.PrepareTemplateStrict=function(b7,b8,b9,b_,b$){var ca,cb;function cc(ch,ci){var cj,ck,cl,cm,cn,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ;function co(cK){}while(true)switch(ch){case 0:if(ci!==null){cj=ci.nextSibling;if(t.Equals(ci.nodeType,o.TEXT_NODE))_.convertTextNode(ci);else if(t.Equals(ci.nodeType,o.ELEMENT_NODE))ce(ci);ci=cj;}else return null;break;case 1:cp=$.string(ci.nodeName,{$:1,$0:3},null).toLowerCase();cq=(ck=cp.indexOf("."),ck===-1?[b7,cp]:[$.string(cp,null,{$:1,$0:ck-1}),$.string(cp,{$:1,$0:ck+1},null)]);cr=cq[1];cs=cq[0];if(cs!==""&&!g.LoadedTemplates().ContainsKey(cs))return _.failNotLoaded(cr);else{if(cs===""&&b$!=null)b$.$0(cr);ct=g.LoadedTemplates().get_Item(cs);if(!ct.ContainsKey(cr))return _.failNotLoaded(cr);else{cu=ct.get_Item(cr);cv=cu.cloneNode(true);cw=new N.New$3();cx=new r.New$5();cy=ci.attributes;for(cz=0,cA=cy.length-1;cz<=cA;cz++){cB=cy.item(cz).name.toLowerCase();cx.set_Item(cB,(cC=cy.item(cz).nodeValue,cC===""?cB:cC.toLowerCase()));!cw.Add(cB)?b3.warn("Hole mapped twice",cB):void 0;}for(cD=0,cE=ci.childNodes.length-1;cD<=cE;cD++){cF=ci.childNodes[cD];t.Equals(cF.nodeType,o.ELEMENT_NODE)?!cw.Add(cF.nodeName.toLowerCase())?b3.warn("Hole filled twice",cr):void 0:void 0;}cG=ci.childNodes.length===1&&t.Equals(ci.firstChild.nodeType,o.TEXT_NODE);if(cG){cm=_.fillTextHole(cv,ci.firstChild.textContent,cr);((function(cK){return function(cL){if(cL!=null)cK(cL.$0);};}((cn=function(cK){return function(cL){return cK.Add(cL);};}(cw),function(cK){return co(cn(cK));})))(cm));}_.removeHolesExcept(cv,cw);if(!cG){for(cH=0,cI=ci.childNodes.length-1;cH<=cI;cH++){cJ=ci.childNodes[cH];t.Equals(cJ.nodeType,o.ELEMENT_NODE)?cJ.hasAttributes()?_.fillInstanceAttrs(cv,cJ):cd(cv,cJ):void 0;}}_.mapHoles(cv,cx);_.fill(cv,ci.parentNode,ci);ci.parentNode.removeChild(ci);return;}}break;}}function cd(ch,ci){var cj,cl,cm;function ck(cn,co){var cp,cq,cr;if(cl==="title"&&ci.hasChildNodes()){cp=b4.parseHTML(ci.textContent);ci.removeChild(ci.firstChild);for(cq=0,cr=cp.length-1;cq<=cr;cq++)ci.appendChild(H.get(cp,cq));}else null;ce(ci);return _.fill(ci,cn,co);}cl=ci.nodeName.toLowerCase();s.IterSelector(ch,"[ws-attr-holes]",function(cn){var co,cp,cq,cr,cs;co=_7.SplitChars(cn.getAttribute("ws-attr-holes"),[" "],1);for(cp=0,cq=co.length-1;cp<=cq;cp++){cr=H.get(co,cp);cn.setAttribute(cr,(cs=new a.RegExp("\\${"+cl+"}","ig"),cn.getAttribute(cr).replace(cs,ci.textContent)));}});cm=ch.querySelector("[ws-hole="+cl+"]");if(t.Equals(cm,null)){cj=ch.querySelector("[ws-replace="+cl+"]");return t.Equals(cj,null)?null:(ck(cj.parentNode,cj),void cj.parentNode.removeChild(cj));}else{while(cm.hasChildNodes())cm.removeChild(cm.lastChild);cm.removeAttribute("ws-hole");return ck(cm,null);}}function ce(ch){if(_7.StartsWith(ch.nodeName.toLowerCase(),"ws-"))cg(ch);else{_.convertAttrs(ch);cf(ch.firstChild);}}function cf(ch){return cc(0,ch);}function cg(ch){return cc(1,ch);}ca=b_==null?g.FakeRoot(b9):b_.$0;cb=(b8==null?"":b8.$0).toLowerCase();g.LoadedTemplateFile(b7).set_Item(cb,ca);H.length(b9)>0?(function(ch){var ci,cj,ck,cl;while(true){ci=ch.querySelector("[ws-template]");if(t.Equals(ci,null)){cj=ch.querySelector("[ws-children-template]");if(t.Equals(cj,null))return null;else{ck=cj.getAttribute("ws-children-template");cj.removeAttribute("ws-children-template");g.PrepareTemplateStrict(b7,{$:1,$0:ck},s.ChildrenArray(cj),null,null);ch=ch;}}else{cl=ci.getAttribute("ws-template");(g.PrepareSingleTemplate(b7,{$:1,$0:cl},ci))(null);ch=ch;}}}(ca),cf(H.get(b9,0))):void 0;};g.PrepareSingleTemplate=function(b7,b8,b9){var b_,b$,ca;b_=g.FakeRootSingle(b9);b$=[b9];ca={$:1,$0:b_};return function(cb){g.PrepareTemplateStrict(b7,b8,b$,ca,cb);};};g.GetOrLoadTemplate=function(b7,b8,b9,b_){g.LoadLocalTemplates("");g.PrepareTemplate(b7,b8,b9);return g.NamedTemplate(b7,b8,b_);};g.PrepareTemplate=function(b7,b8,b9){var b_,b$,ca,cb,cc;if(!g.LoadedTemplateFile(b7).ContainsKey(b8==null?"":b8.$0)){b_=b9();for(b$=0,ca=b_.length-1;b$<=ca;b$++){cb=H.get(b_,b$);cc=cb.parentNode;t.Equals(cc,null)?void 0:cc.removeChild(cb);}g.PrepareTemplateStrict(b7,b8,b_,null,null);}};g.TextHoleRE=function(){M.$cctor();return M.TextHoleRE;};g.NamedTemplate=function(b7,b8,b9){var b_,b$;b_=(b$=null,[g.LoadedTemplateFile(b7).TryGetValue(b8==null?"":b8.$0,{get:function(){return b$;},set:function(ca){b$=ca;}}),b$]);return b_[0]?g.ChildrenTemplate(b_[1].cloneNode(true),b9):(b3.warn("Local template doesn't exist",b8),i.get_Empty());};g.ChildrenTemplate=function(b7,b8){var b9,b_,b$,ca,cb;b9=g.InlineTemplate(b7,b8);b_=b9[1];b$=b9[0];ca=b$.Els;return!t.Equals(ca,null)&&ca.length===1&&(H.get(ca,0)instanceof o&&(t.Equals(H.get(ca,0).nodeType,o.ELEMENT_NODE)&&(cb=H.get(ca,0),true)))?bA.TreeNode(b$,b_):i.Mk({$:6,$0:b$},b_);};g.InlineTemplate=function(b7,b8){var b9,b_,b$,ca,cd,ce,cf,cg,ch,ci,cj;function cb(ck,cl){var cm,cn,co;cm=_2.Insert(ck,cl);ce.push(_2.Updates(cm));cf.push([ck,cm]);cn=b2.GetOptional(cm.OnAfterRender);return cn==null?null:(co=cn.$0,void cg.push(function(){co(ck);}));}function cc(ck){var cl,cm;cl=(cm=null,[ch.TryGetValue(ck,{get:function(){return cm;},set:function(cn){cm=cn;}}),cm]);return cl[0]?cl[1].$==0?{$:1,$0:cl[1].$1}:cl[1].$==1?{$:1,$0:i.TextNode(cl[1].$1)}:cl[1].$==2?{$:1,$0:i.TextView(cl[1].$1)}:cl[1].$==8?{$:1,$0:i.TextView(cl[1].$1.get_View())}:cl[1].$==9?{$:1,$0:i.TextView(K.Map(a.String,cl[1].$1.get_View()))}:cl[1].$==10?{$:1,$0:i.TextView(K.Map(function(cn){return cn.get_Input();},cl[1].$1.get_View()))}:cl[1].$==11?{$:1,$0:i.TextView(K.Map(a.String,cl[1].$1.get_View()))}:cl[1].$==12?{$:1,$0:i.TextView(K.Map(function(cn){return cn.get_Input();},cl[1].$1.get_View()))}:cl[1].$==13?{$:1,$0:i.TextView(K.Map(a.String,cl[1].$1.get_View()))}:(b3.warn("Content hole filled with attribute data",ck),null):null;}cd=[];ce=[];cf=[];cg=[];ch=new r.New$5();ci=ba.Get(b8);try{while(ci.MoveNext()){cj=ci.Current();ch.set_Item(cj.$0,cj);}}finally{if(typeof ci=="object"&&"Dispose"in ci)ci.Dispose();}b9=s.ChildrenArray(b7);s.IterSelector(b7,"[ws-hole]",function(ck){var cl,cm,cn;cn=ck.getAttribute("ws-hole");ck.removeAttribute("ws-hole");while(ck.hasChildNodes())ck.removeChild(ck.lastChild);cl=cc(cn);cl!=null&&cl.$==1?(cm=cl.$0,R.LinkElement(ck,cm.docNode),cd.push(bc.New(_2.Empty(ck),cm.docNode,null,ck,bl.Int(),null)),ce.push(cm.updates)):void 0;});s.IterSelector(b7,"[ws-replace]",function(ck){var cl,cm,cn,co,cp,cq;cl=cc(ck.getAttribute("ws-replace"));cl!=null&&cl.$==1?(cm=cl.$0,cn=ck.parentNode,co=self.document.createTextNode(""),cn.replaceChild(co,ck),cp=R.InsertBeforeDelim(co,cm.docNode),cq=H.tryFindIndex(function(cr){return ck===cr;},b9),cq==null?void 0:H.set(b9,cq.$0,cm.docNode),cd.push(bc.New(_2.Empty(cn),cm.docNode,{$:1,$0:[cp,co]},cn,bl.Int(),null)),ce.push(cm.updates)):void 0;});s.IterSelector(b7,"[ws-attr]",function(ck){var cl,cm,cn;cl=ck.getAttribute("ws-attr");ck.removeAttribute("ws-attr");cm=(cn=null,[ch.TryGetValue(cl,{get:function(){return cn;},set:function(co){cn=co;}}),cn]);cm[0]?cm[1].$==3?cb(ck,cm[1].$1):b3.warn("Attribute hole filled with non-attribute data",cl):void 0;});s.IterSelector(b7,"[ws-on]",function(ck){cb(ck,_1.Concat(H.choose(function(cl){var cm,cn,co;cm=_7.SplitChars(cl,[":"],1);cn=(co=null,[ch.TryGetValue(H.get(cm,1),{get:function(){return co;},set:function(cp){co=cp;}}),co]);return cn[0]?cn[1].$==4?{$:1,$0:B.Handler(H.get(cm,0),cn[1].$1)}:cn[1].$==5?{$:1,$0:_1.Handler(H.get(cm,0),cn[1].$2)}:(b3.warn("Event hole on"+H.get(cm,0)+" filled with non-event data",H.get(cm,1)),null):null;},_7.SplitChars(ck.getAttribute("ws-on"),[" "],1))));ck.removeAttribute("ws-on");});s.IterSelector(b7,"[ws-onafterrender]",function(ck){var cl,cm,cn;cl=ck.getAttribute("ws-onafterrender");cm=(cn=null,[ch.TryGetValue(cl,{get:function(){return cn;},set:function(co){cn=co;}}),cn]);cm[0]?cm[1].$==6?(ck.removeAttribute("ws-onafterrender"),cb(ck,B.OnAfterRender(cm[1].$1))):cm[1].$==7?(ck.removeAttribute("ws-onafterrender"),cb(ck,B.OnAfterRender(cm[1].$1))):b3.warn("onafterrender hole filled with non-onafterrender data",cl):void 0;});s.IterSelector(b7,"[ws-var]",function(ck){var cl,cm,cn;cl=ck.getAttribute("ws-var");ck.removeAttribute("ws-var");cm=(cn=null,[ch.TryGetValue(cl,{get:function(){return cn;},set:function(co){cn=co;}}),cn]);cm[0]?cm[1].$==8?cb(ck,B.Value(cm[1].$1)):cm[1].$==9?cb(ck,B.Checked(cm[1].$1)):cm[1].$==10?cb(ck,B.IntValue(cm[1].$1)):cm[1].$==11?cb(ck,B.IntValueUnchecked(cm[1].$1)):cm[1].$==12?cb(ck,B.FloatValue(cm[1].$1)):cm[1].$==13?cb(ck,B.FloatValueUnchecked(cm[1].$1)):b3.warn("Var hole filled with non-Var data",cl):void 0;});s.IterSelector(b7,"[ws-attr-holes]",function(ck){var cl,cm,cn,co;cl=new a.RegExp(g.TextHoleRE(),"g");cm=_7.SplitChars(ck.getAttribute("ws-attr-holes"),[" "],1);ck.removeAttribute("ws-attr-holes");for(cn=0,co=cm.length-1;cn<=co;cn++)(function(){var cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB;cy=H.get(cm,cn);cz=ck.getAttribute(cy);cp=null;cq=0;cA=[];while(cp=cl.exec(cz),cp!==null){cB=$.string(cz,{$:1,$0:cq},{$:1,$0:cl.lastIndex-H.get(cp,0).length-1});cq=cl.lastIndex;cA.push([cB,H.get(cp,1)]);}cs=$.string(cz,{$:1,$0:cq},null);cl.lastIndex=0;ct=H.foldBack(function(cC,cD){return(function(cE){var cF,cG;cF=cE[0];cG=cE[1];return function(cH){var cI,cJ,cK,cL,cM;cI=cH[0];cJ=cH[1];cK=(cL=(cM=null,[ch.TryGetValue(cG,{get:function(){return cM;},set:function(cN){cM=cN;}}),cM]),cL[0]?cL[1].$==1?{$:0,$0:cL[1].$1}:cL[1].$==2?{$:1,$0:cL[1].$1}:cL[1].$==8?{$:1,$0:cL[1].$1.get_View()}:cL[1].$==9?{$:1,$0:K.Map(a.String,cL[1].$1.get_View())}:cL[1].$==10?{$:1,$0:K.Map(function(cN){return cN.get_Input();},cL[1].$1.get_View())}:cL[1].$==11?{$:1,$0:K.Map(a.String,cL[1].$1.get_View())}:cL[1].$==12?{$:1,$0:K.Map(function(cN){return cN.get_Input();},cL[1].$1.get_View())}:cL[1].$==13?{$:1,$0:K.Map(a.String,cL[1].$1.get_View())}:(b3.warn("Attribute value hole filled with non-text data",cG),{$:0,$0:""}):{$:0,$0:""});return cK.$==1?[cF,new x({$:1,$0:cI===""?cK.$0:K.Map(function(cN){return cN+cI;},cK.$0),$1:cJ})]:[cF+cK.$0+cI,cJ];};}(cC))(cD);},cA,[cs,x.Empty]);return cb(ck,ct[1].$==1?ct[1].$1.$==1?ct[1].$1.$1.$==1?ct[1].$1.$1.$1.$==0?(cu=ct[0],B.Dynamic(cy,K.Map3(function(cC,cD,cE){return cu+cC+cD+cE;},ct[1].$0,ct[1].$1.$0,ct[1].$1.$1.$0))):(cv=ct[0],B.Dynamic(cy,K.Map(function(cC){return cv+_7.concat("",cC);},K.Sequence(ct[1])))):(cw=ct[0],B.Dynamic(cy,K.Map2(function(cC,cD){return cw+cC+cD;},ct[1].$0,ct[1].$1.$0))):ct[0]===""?B.Dynamic(cy,ct[1].$0):(cx=ct[0],B.Dynamic(cy,K.Map(function(cC){return cx+cC;},ct[1].$0))):_1.Create(cy,ct[0]));}());});return[b2.DeleteEmptyFields({Els:b9,Dirty:true,Holes:cd,Attrs:cf,Render:(b_=cg.length==0?null:{$:1,$0:function(ck){H.iter(function(cl){cl(ck);},cg);}},b_?b_.$0:void 0),El:(b$=!t.Equals(b9,null)&&b9.length===1&&(H.get(b9,0)instanceof o&&(H.get(b9,0)instanceof a.Element&&(ca=H.get(b9,0),true)))?{$:1,$0:ca}:null,b$?b$.$0:void 0)},["Render","El"]),_3.TreeReduce(K.Const(),K.Map2Unit,ce)];};h=d.Obj=b2.Class({Equals:function(b7){return this===b7;},GetHashCode:function(){return -1;}},null,h);h.New=b2.Ctor(function(){},h);i=e.Doc=b2.Class({},h,i);i.RunById=function(b7,b8){var b9;b9=s.Doc().getElementById(b7);t.Equals(b9,null)?m.FailWith("invalid id: "+b7):i.Run(b9,b8);};i.Run=function(b7,b8){R.LinkElement(b7,b8.docNode);i.RunInPlace(false,b7,b8);};i.Concat=function(b7){var b8;b8=_3.ofSeqNonCopying(b7);return _3.TreeReduce(i.get_Empty(),i.Append,b8);};i.get_Empty=function(){return i.Mk(null,K.Const());};i.RunInPlace=function(b7,b8,b9){var b_;b_=R.CreateRunState(b8,b9.docNode);K.Sink(be.get_UseAnimations()||bf.BatchUpdatesEnabled()?bh.StartProcessor(R.PerformAnimatedUpdate(b7,b_,b9.docNode)):function(){R.PerformSyncUpdate(b7,b_,b9.docNode);},b9.updates);};i.CheckBox=function(b7,b8){return i.InputInternal("input",function(){return O.append(b7,[_1.Create("type","checkbox"),B.Checked(b8)]);});};i.EmbedView=function(b7){var b8;b8=R.CreateEmbedNode();return i.Mk({$:2,$0:b8},K.Map(a.ignore,K.Bind(function(b9){R.UpdateEmbedNode(b8,b9.docNode);return b9.updates;},b7)));};i.Append=function(b7,b8){return i.Mk({$:0,$0:b7.docNode,$1:b8.docNode},K.Map2Unit(b7.updates,b8.updates));};i.Link=function(b7,b8,b9){var b_,b$;b_=(b$=_1.Concat(b8),_1.Append(_1.Create("href","#"),b$));return bA.New(i.Clickable("a",b9),b_,i.TextNode(b7));};i.Button=function(b7,b8,b9){var b_;b_=_1.Concat(b8);return bA.New(i.Clickable("button",b9),b_,i.TextNode(b7));};i.Mk=function(b7,b8){return new i.New(b7,b8);};i.Flatten=function(b7){return i.EmbedView(K.Map(i.Concat,b7));};i.InputInternal=function(b7,b8){var b9;b9=s.CreateElement(b7);return bA.New(b9,_1.Concat(b8(b9)),i.get_Empty());};i.Element=function(b7,b8,b9){var b_,b$;b_=_1.Concat(b8);b$=i.Concat(b9);return bA.New(s.CreateElement(b7),b_,b$);};i.TextNode=function(b7){return i.Mk({$:5,$0:s.CreateText(b7)},K.Const());};i.Clickable=function(b7,b8){var b9;b9=s.CreateElement(b7);b9.addEventListener("click",function(b_){b_.preventDefault();return b8();},false);return b9;};i.Input=function(b7,b8){return i.InputInternal("input",function(){return O.append(b7,[B.Value(b8)]);});};i.TextView=function(b7){var b8;b8=R.CreateTextNode();return i.Mk({$:4,$0:b8},K.Map(function(b9){R.UpdateTextNode(b8,b9);},b7));};i.New=b2.Ctor(function(b7,b8){h.New.call(this);this.docNode=b7;this.updates=b8;},i);k.NewFromSeq=function(b7){var b8,b9,b_;b8={};b9=ba.Get(b7);try{while(b9.MoveNext()){b_=b9.Current();b8[b_[0]]=b_[1];}}finally{if(typeof b9=="object"&&"Dispose"in b9)b9.Dispose();}return b8;};l.$cctor=function(){var b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co;l.$cctor=a.ignore;function cp(cr){c.onEnter(cr,function(){var cs;cs=_7.Trim(b9.Get());cs!==""?(b7.Append(c.mkTodo(cs)),A.Set(b9,"")):void 0;});}function cq(cr){return B.DynamicClass("selected",b8.get_View(),function(cs){return t.Equals(cr,cs);});}l.Pages=u.Create(function(cr){return cr.$==1?w.ofArray(["active"]):cr.$==2?w.ofArray(["completed"]):x.Empty;},function(cr){var cs;switch(cr.$==1?cr.$0==="active"?cr.$1.$==0?0:2:cr.$0==="completed"?cr.$1.$==0?1:2:2:2){case 0:return v.Active;case 1:return v.Completed;case 2:return v.All;}});l.runningId=0;l.TodoApp=(b7=y.Create(function(cr){return cr.Id;},x.Empty),(b8=u.Install(c.Pages()),(b9=A.Create$1(""),(b_=A.Create$1(false),(b$=c.notDoneItemsCount(b7),(ca=K.Map(function(cr){return cr===0;},b$),(cb=(cc=c.ShowIfNotEmpty(b7,(cd=(ce=i.EmbedView(K.Map(function(cr){return cr?i.Button("Clear Completed",[c.op_EqualsEqualsGreater("class","clear-completed")],function(){c.RemoveCompleted(b7);}):i.get_Empty();},c.hasAnyDoneItems(b7))),(cf=w.ofArray([i.Element("li",[],[i.Link("All",[cq(v.All)],function(){A.Set(b8,v.All);})]),i.Element("li",[],[i.Link("Active",[cq(v.Active)],function(){A.Set(b8,v.Active);})]),i.Element("li",[],[i.Link("Completed",[cq(v.Completed)],function(){A.Set(b8,v.Completed);})])]),(cg=K.Map(function(cr){return cr===1?"item":"items";},b$),(ch=K.Map(a.String,b$),I.Make().WithHole({$:2,$0:"remaining",$1:ch})).WithHole({$:2,$0:"remaininglabel",$1:cg})).WithHole({$:0,$0:"filters",$1:i.Concat(cf)})).WithHole({$:0,$0:"clearcompleted",$1:ce})),(ci=J.CompleteHoles(cd.k,cd.h,[]),(cj=new G.New(ci[1],L.footertemplate(ci[0])),(cd.i=cj,cj)))).get_Doc()),(ck=c.ShowIfNotEmpty(b7,i.EmbedView(K.Map(function(){return i.CheckBox([c.op_EqualsEqualsGreater("class","toggle-all"),c.op_EqualsEqualsGreater("type","checkbox"),B.Handler("click",function(){return function(){return c.ToggleAllDone(b7);};})],b_);},ca))),(cl=(cm=c.RenderList(b7,b8.get_View()),I.Make().WithHole({$:8,$0:"newtask",$1:b9}).WithHole({$:0,$0:"todolist",$1:cm})),cl.WithHole(J.EventQ2(cl.k,"add",function(){return cl.i;},function(cr){cp(cr.Event);}))).WithHole({$:0,$0:"toggleall",$1:ck})).WithHole({$:0,$0:"footer",$1:cc})),(cn=J.CompleteHoles(cb.k,cb.h,[["newtask",0]]),(co=new G.New(cn[1],L.t(cn[0])),(cb.i=co,co)))).get_Doc()))))));};m.FailWith=function(b7){throw new bT(b7);};m.KeyValue=function(b7){return[b7.K,b7.V];};p.GetFieldValues=function(b7){var b8,b9;b8=[];for(var b_ in b7)b8.push(b7[b_]);return b8;};r=q.Dictionary=b2.Class({set_Item:function(b7,b8){this.set(b7,b8);},ContainsKey:function(b7){var b8,b9;b8=this;b9=this.data[this.hash(b7)];return b9==null?false:H.exists(function(b_){return b8.equals.apply(null,[(m.KeyValue(b_))[0],b7]);},b9);},TryGetValue:function(b7,b8){var b9,b_,b$;b9=this;b_=this.data[this.hash(b7)];return b_==null?false:(b$=H.tryPick(function(ca){var cb;cb=m.KeyValue(ca);return b9.equals.apply(null,[cb[0],b7])?{$:1,$0:cb[1]}:null;},b_),b$!=null&&b$.$==1&&(b8.set(b$.$0),true));},Remove:function(b7){return this.remove(b7);},get_Keys:function(){return new bb.New(this);},set:function(b7,b8){var b9,b_,b$,ca;b9=this;b_=this.hash(b7);b$=this.data[b_];b$==null?(this.count=this.count+1,this.data[b_]=new a.Array({K:b7,V:b8})):(ca=H.tryFindIndex(function(cb){return b9.equals.apply(null,[(m.KeyValue(cb))[0],b7]);},b$),ca==null?(this.count=this.count+1,b$.push({K:b7,V:b8})):b$[ca.$0]={K:b7,V:b8});},remove:function(b7){var b8,b9,b_,b$;b8=this;b9=this.hash(b7);b_=this.data[b9];return b_==null?false:(b$=H.filter(function(ca){return!b8.equals.apply(null,[(m.KeyValue(ca))[0],b7]);},b_),H.length(b$)<b_.length&&(this.count=this.count-1,this.data[b9]=b$,true));},get_Item:function(b7){return this.get(b7);},get:function(b7){var b8,b9;b8=this;b9=this.data[this.hash(b7)];return b9==null?_8.notPresent():H.pick(function(b_){var b$;b$=m.KeyValue(b_);return b8.equals.apply(null,[b$[0],b7])?{$:1,$0:b$[1]}:null;},b9);},Clear:function(){this.data=[];this.count=0;},GetEnumerator:function(){return ba.Get0(this);},GetEnumerator0:function(){return ba.Get0(H.concat(p.GetFieldValues(this.data)));}},h,r);r.New$5=b2.Ctor(function(){r.New$6.call(this,[],t.Equals,t.Hash);},r);r.New$6=b2.Ctor(function(b7,b8,b9){var b_,b$;h.New.call(this);this.equals=b8;this.hash=b9;this.count=0;this.data=[];b_=ba.Get(b7);try{while(b_.MoveNext()){b$=b_.Current();this.set(b$.K,b$.V);}}finally{if(typeof b_=="object"&&"Dispose"in b_)b_.Dispose();}},r);s.Doc=function(){Q.$cctor();return Q.Doc;};s.ChildrenArray=function(b7){var b8,b9,b_;b8=[];for(b9=0,b_=b7.childNodes.length-1;b9<=b_;b9++)b8.push(b7.childNodes[b9]);return b8;};s.IterSelector=function(b7,b8,b9){var b_,b$,ca;b_=b7.querySelectorAll(b8);for(b$=0,ca=b_.length-1;b$<=ca;b$++)b9(b_[b$]);};s.AddClass=function(b7,b8){var b9;b9=s.getClass(b7);b9===""?s.setClass(b7,b8):!s.clsRE(b8).test(b9)?s.setClass(b7,b9+" "+b8):void 0;};s.RemoveClass=function(b7,b8){var b9;s.setClass(b7,(b9=s.clsRE(b8),s.getClass(b7).replace(b9,function(b_,b$,ca){return b$===""||ca===""?"":" ";})));};s.SetAttr=function(b7,b8,b9){b7.setAttribute(b8,b9);};s.getClass=function(b7){return b7 instanceof a.SVGElement?b7.getAttribute("class"):b7.className;};s.setClass=function(b7,b8){if(b7 instanceof a.SVGElement)b7.setAttribute("class",b8);else b7.className=b8;};s.clsRE=function(b7){return new a.RegExp("(\\s+|^)"+b7+"(?:\\s+"+b7+")*(\\s+|$)","g");};s.CreateElement=function(b7){return s.Doc().createElement(b7);};s.CreateText=function(b7){return s.Doc().createTextNode(b7);};s.InsertAt=function(b7,b8,b9){var b_;if(!(b9.parentNode===b7&&b8===(b_=b9.nextSibling,t.Equals(b_,null)?null:b_)))b7.insertBefore(b9,b8);};s.RemoveNode=function(b7,b8){if(b8.parentNode===b7)b7.removeChild(b8);};t.Equals=function(b7,b8){var b9,b_,b$,ca;if(b7===b8)return true;else{b9=typeof b7;if(b9=="object"){if(b7===null||b7===void 0||b8===null||b8===void 0)return false;else if("Equals"in b7)return b7.Equals(b8);else if(b7 instanceof a.Array&&b8 instanceof a.Array)return t.arrayEquals(b7,b8);else if(b7 instanceof a.Date&&b8 instanceof a.Date)return t.dateEquals(b7,b8);else{b_=[true];for(var cb in b7)if(function(cc){b_[0]=!b7.hasOwnProperty(cc)||b8.hasOwnProperty(cc)&&t.Equals(b7[cc],b8[cc]);return!b_[0];}(cb))break;if(b_[0]){for(var cc in b8)if(function(cd){b_[0]=!b8.hasOwnProperty(cd)||b7.hasOwnProperty(cd);return!b_[0];}(cc))break;}return b_[0];}}else return b9=="function"&&("$Func"in b7?b7.$Func===b8.$Func&&b7.$Target===b8.$Target:"$Invokes"in b7&&"$Invokes"in b8&&t.arrayEquals(b7.$Invokes,b8.$Invokes));}};t.arrayEquals=function(b7,b8){var b9,b_;if(H.length(b7)===H.length(b8)){b9=true;b_=0;while(b9&&b_<H.length(b7)){!t.Equals(H.get(b7,b_),H.get(b8,b_))?b9=false:void 0;b_=b_+1;}return b9;}else return false;};t.dateEquals=function(b7,b8){return b7.getTime()===b8.getTime();};t.Hash=function(b7){var b8;b8=typeof b7;return b8=="function"?0:b8=="boolean"?b7?1:0:b8=="number"?b7:b8=="string"?t.hashString(b7):b8=="object"?b7==null?0:b7 instanceof a.Array?t.hashArray(b7):t.hashObject(b7):0;};t.hashString=function(b7){var b8,b9,b_;if(b7===null)return 0;else{b8=5381;for(b9=0,b_=b7.length-1;b9<=b_;b9++)b8=t.hashMix(b8,b7[b9].charCodeAt());return b8;}};t.hashArray=function(b7){var b8,b9,b_;b8=-34948909;for(b9=0,b_=H.length(b7)-1;b9<=b_;b9++)b8=t.hashMix(b8,t.Hash(H.get(b7,b9)));return b8;};t.hashObject=function(b7){var b8,b9;if("GetHashCode"in b7)return b7.GetHashCode();else{b8=[0];for(var b_ in b7)if(function(b$){b8[0]=t.hashMix(t.hashMix(b8[0],t.hashString(b$)),t.Hash(b7[b$]));return false;}(b_))break;return b8[0];}};t.hashMix=function(b7,b8){return(b7<<5)+b7+b8;};t.Compare=function(b7,b8){var b9,b_,b$,ca,cb,cc;if(b7===b8)return 0;else{b_=typeof b7;switch(b_=="function"?1:b_=="boolean"?2:b_=="number"?2:b_=="string"?2:b_=="object"?3:0){case 0:return typeof b8=="undefined"?0:-1;case 1:return m.FailWith("Cannot compare function values.");case 2:return b7<b8?-1:1;case 3:if(b7===null)b$=-1;else if(b8===null)b$=1;else if("CompareTo"in b7)b$=b7.CompareTo(b8);else if("CompareTo0"in b7)b$=b7.CompareTo0(b8);else if(b7 instanceof a.Array&&b8 instanceof a.Array)b$=t.compareArrays(b7,b8);else if(b7 instanceof a.Date&&b8 instanceof a.Date)b$=t.compareDates(b7,b8);else{ca=[0];for(var cd in b7)if(function(ce){return!b7.hasOwnProperty(ce)?false:!b8.hasOwnProperty(ce)?(ca[0]=1,true):(ca[0]=t.Compare(b7[ce],b8[ce]),ca[0]!==0);}(cd))break;if(ca[0]===0){for(var ce in b8)if(function(cf){return!b8.hasOwnProperty(cf)?false:!b7.hasOwnProperty(cf)&&(ca[0]=-1,true);}(ce))break;}b$=ca[0];}return b$;}}};t.compareArrays=function(b7,b8){var b9,b_;if(H.length(b7)<H.length(b8))return -1;else if(H.length(b7)>H.length(b8))return 1;else{b9=0;b_=0;while(b9===0&&b_<H.length(b7)){b9=t.Compare(H.get(b7,b_),H.get(b8,b_));b_=b_+1;}return b9;}};t.compareDates=function(b7,b8){return t.Compare(b7.getTime(),b8.getTime());};u.Create=function(b7,b8){function b9(b_){return b_[0];}return{Des:function(b_){return b8(b9(b_));},Ser:function(b_){return[b7(b_),new bi.New([])];}};};u.Install=function(b7){return V.InstallMap(b7);};v.Active={$:1};v.Completed={$:2};v.All={$:0};w.ofArray=function(b7){var b8,b9,b_;b8=x.Empty;for(b9=H.length(b7)-1,b_=0;b9>=b_;b9--)b8=new x({$:1,$0:H.get(b7,b9),$1:b8});return b8;};w.ofSeq=function(b7){var b8,b9,b_,b$,ca,cb;if(b7 instanceof x)return b7;else if(b7 instanceof a.Array)return w.ofArray(b7);else{b8=ba.Get(b7);try{b_=b8.MoveNext();if(!b_)b9=x.Empty;else{ca=new x({$:1});b$=ca;while(b_){b$.$0=b8.Current();b8.MoveNext()?b$=(cb=new x({$:1}),b$.$1=cb,cb):b_=false;}b$.$1=x.Empty;b9=ca;}return b9;}finally{if(typeof b8=="object"&&"Dispose"in b8)b8.Dispose();}}};w.head=function(b7){return b7.$==1?b7.$0:w.listEmpty();};w.tail=function(b7){return b7.$==1?b7.$1:w.listEmpty();};w.listEmpty=function(){return m.FailWith("The input list was empty.");};x=w.T=b2.Class({GetEnumerator:function(){return new bp.New(this,null,function(b7){var b8;b8=b7.s;return b8.$==0?false:(b7.c=b8.$0,b7.s=b8.$1,true);},void 0);},GetEnumerator0:function(){return ba.Get(this);}},null,x);x.Empty=new x({$:0});y.Create=function(b7,b8){return y.CreateWithStorage(b7,T.InMemory(H.ofSeq(b8)));};y.CreateWithStorage=function(b7,b8){return new y.New(b7,b8);};z.New=function(b7,b8,b9,b_){return{Id:b7,Text:b8,IsDone:b9,IsEditing:b_};};A=e.Var$1=b2.Class({},h,A);A.Create$1=function(b7){return new W.New(false,X.New({$:2,$0:b7,$1:[]}),b7);};A.Set=function(b7,b8){b7.Set(b8);};A.Lens=function(b7,b8,b9){var b_,b$,ca;b_=bl.Id();b$=K.Map(b8,b7.get_View());ca=new C({Get:function(){return b8(b7.Get());},Set:function(cb){return b7.Update(function(cc){return b9(cc,cb);});},SetFinal:function(cb){return this.Set(cb);},Update:function(cb){return b7.Update(function(cc){return b9(cc,cb(b8(cc)));});},UpdateMaybe:function(cb){return b7.UpdateMaybe(function(cc){var cd;cd=cb(b8(cc));return cd==null?null:{$:1,$0:b9(cc,cd.$0)};});},get_View:function(){return b$;},get_Id:function(){return b_;}});C.New.call(ca);return ca;};B.DynamicClass=function(b7,b8,b9){return B.DynamicClassPred(b7,K.Map(b9,b8));};B.Handler=function(b7,b8){return _2.Static(function(b9){b9.addEventListener(b7,function(b_){return(b8(b9))(b_);},false);});};B.DynamicClassPred=function(b7,b8){return _2.Dynamic(b8,function(b9){return function(b_){return b_?s.AddClass(b9,b7):s.RemoveClass(b9,b7);};});};B.Checked=function(b7){function b8(b9,b_){return!t.Equals(b7.Get(),b9.checked)?b7.Set(b9.checked):null;}return _1.Concat([B.DynamicProp("checked",b7.get_View()),B.Handler("change",function(b9){return function(b_){return b8(b9,b_);};})]);};B.HandlerView=function(b7,b8,b9){return _2.Static(function(b_){var b$;b$=b9(b_);b_.addEventListener(b7,function(ca){return K.Get(b$(ca),b8);},false);});};B.OnAfterRender=function(b7){return new _1({$:4,$0:b7});};B.DynamicProp=function(b7,b8){return _2.Dynamic(b8,function(b9){return function(b_){b9[b7]=b_;};});};B.Value=function(b7){function b8(b9){return{$:1,$0:b9};}return B.CustomValue(b7,a.id,function(b9){return b8(a.id(b9));});};B.CustomValue=function(b7,b8,b9){return B.CustomVar(b7,function(b_,b$){b_.value=b8(b$);},function(b_){return b9(b_.value);});};B.CustomVar=function(b7,b8,b9){function b_(ca,cb){return b7.UpdateMaybe(function(cc){var cd,ce;cd=b9(ca);return cd!=null&&cd.$==1&&(!t.Equals(cd.$0,cc)&&(ce=[cd,cd.$0],true))?ce[0]:null;});}function b$(ca,cb){var cc,cd;cc=b9(ca);return cc!=null&&cc.$==1&&(t.Equals(cc.$0,cb)&&(cd=cc.$0,true))?null:b8(ca,cb);}return _1.Concat([B.Handler("change",function(ca){return function(cb){return b_(ca,cb);};}),B.Handler("input",function(ca){return function(cb){return b_(ca,cb);};}),B.Handler("keypress",function(ca){return function(cb){return b_(ca,cb);};}),B.DynamicCustom(function(ca){return function(cb){return b$(ca,cb);};},b7.get_View())]);};B.IntValue=function(b7){return B.CustomVar(b7,function(b8,b9){var b_;b_=b9.get_Input();return b8.value!==b_?void(b8.value=b_):null;},function(b8){var b9,b_,b$;b9=b8.value;return{$:1,$0:bX.isBlank(b9)?(b8.checkValidity?b8.checkValidity():true)?new bo({$:2,$0:b9}):new bo({$:1,$0:b9}):(b_=(b$=0,[U.TryParseInt32(b9,{get:function(){return b$;},set:function(ca){b$=ca;}}),b$]),b_[0]?new bo({$:0,$0:b_[1],$1:b9}):new bo({$:1,$0:b9}))};});};B.IntValueUnchecked=function(b7){return B.CustomValue(b7,a.String,function(b8){var b9;return bX.isBlank(b8)?{$:1,$0:0}:(b9=+b8,b9!==b9>>0?null:{$:1,$0:b9});});};B.FloatValue=function(b7){return B.CustomVar(b7,function(b8,b9){var b_;b_=b9.get_Input();return b8.value!==b_?void(b8.value=b_):null;},function(b8){var b9,b_;b9=b8.value;return{$:1,$0:bX.isBlank(b9)?(b8.checkValidity?b8.checkValidity():true)?new bo({$:2,$0:b9}):new bo({$:1,$0:b9}):(b_=+b9,a.isNaN(b_)?new bo({$:1,$0:b9}):new bo({$:0,$0:b_,$1:b9}))};});};B.FloatValueUnchecked=function(b7){return B.CustomValue(b7,a.String,function(b8){var b9;return bX.isBlank(b8)?{$:1,$0:0}:(b9=+b8,a.isNaN(b9)?null:{$:1,$0:b9});});};B.Dynamic=function(b7,b8){return _2.Dynamic(b8,function(b9){return function(b_){return s.SetAttr(b9,b7,b_);};});};B.DynamicCustom=function(b7,b8){return _2.Dynamic(b8,b7);};C=e.Var=b2.Class({},h,C);C.New=b2.Ctor(function(){h.New.call(this);},C);G=F.TemplateInstance=b2.Class({get_Doc:function(){return this.doc;}},h,G);G.New=b2.Ctor(function(b7,b8){h.New.call(this);this.doc=b8;this.allVars=b7.$==0?b7.$0:m.FailWith("Should not happen");},G);H.get=function(b7,b8){H.checkBounds(b7,b8);return b7[b8];};H.length=function(b7){return b7.dims===2?b7.length*b7.length:b7.length;};H.checkBounds=function(b7,b8){if(b8<0||b8>=b7.length)m.FailWith("Index was outside the bounds of the array.");};H.set=function(b7,b8,b9){H.checkBounds(b7,b8);b7[b8]=b9;};I=F.ProviderBuilder=b2.Class({WithHole:function(b7){this.h.push(b7);return this;}},null,I);I.Make=function(){var b7;return I.New(null,(b7=_0.NewGuid(),a.String(b7)),[]);};I.New=function(b7,b8,b9){return new I({i:b7,k:b8,h:b9});};J.EventQ2=function(b7,b8,b9,b_){return{$:5,$0:b8,$1:true,$2:function(b$){return function(ca){return b_({Vars:b9(),Target:b$,Event:ca});};}};};J.CompleteHoles=function(b7,b8,b9){var b$,ca,cb,cc,cd,ce;function b_(cf,cg){var ch,ci,cj,ck;return ca.Contains(cf)?null:(ch=cg===0?(ci=A.Create$1(""),[{$:8,$0:cf,$1:ci},ci]):cg===1?(cj=A.Create$1(0),[{$:13,$0:cf,$1:cj},cj]):cg===2?(ck=A.Create$1(false),[{$:9,$0:cf,$1:ck},ck]):m.FailWith("Invalid value type"),(b$.set_Item(cf,ch[1]),{$:1,$0:ch[0]}));}b$=new r.New$5();ca=new N.New$3();cb=ba.Get(b8);try{while(cb.MoveNext()){cc=cb.Current();(cc.$==8?(cd=[cc.$0,_4.Box(cc.$1)],true):cc.$==11?(cd=[cc.$0,_4.Box(cc.$1)],true):cc.$==10?(cd=[cc.$0,_4.Box(cc.$1)],true):cc.$==13?(cd=[cc.$0,_4.Box(cc.$1)],true):cc.$==12?(cd=[cc.$0,_4.Box(cc.$1)],true):cc.$==9&&(cd=[cc.$0,_4.Box(cc.$1)],true))?(ce=cd[0],ca.Add(ce),b$.set_Item(ce,cd[1])):void 0;}}finally{if(typeof cb=="object"&&"Dispose"in cb)cb.Dispose();}return[O.append(b8,H.choose(function(cf){return b_(cf[0],cf[1]);},b9)),{$:0,$0:b$}];};K.Map=function(b7,b8){return K.CreateLazy(function(){return X.Map(b7,b8());});};K.CreateLazy=function(b7){var b8;b8={c:null,o:b7};return function(){var b9,b_;b9=b8.c;return b9===null?(b9=b8.o(),b8.c=b9,(b_=b9.s,b_!=null&&b_.$==0)?b8.o=null:X.WhenObsoleteRun(b9,function(){b8.c=null;}),b9):b9;};};K.Const=function(b7){var b8;b8=X.New({$:0,$0:b7});return function(){return b8;};};K.Sink=function(b7,b8){function b9(){X.WhenRun(b8(),b7,function(){bC.scheduler().Fork(b9);});}bC.scheduler().Fork(b9);};K.Map2=function(b7,b8,b9){return K.CreateLazy(function(){return X.Map2(b7,b8(),b9());});};K.Bind=function(b7,b8){return K.Join(K.Map(b7,b8));};K.Map2Unit=function(b7,b8){return K.CreateLazy(function(){return X.Map2Unit(b7(),b8());});};K.Join=function(b7){return K.CreateLazy(function(){return X.Join(b7());});};K.MapSeqCachedViewBy=function(b7,b8,b9){var b_;b_=[new r.New$5()];return K.Map(function(b$){var ca,cb,cc;ca=b_[0];cb=new r.New$5();cc=_3.mapInPlace(function(cd){var ce,cf,cg;ce=b7(cd);cf=ca.ContainsKey(ce)?(cg=ca.get_Item(ce),(A.Set(cg.r,cd),cg)):K.ConvertSeqNode(function(ch){return b8(ce,ch);},cd);cb.set_Item(ce,cf);return cf.e;},H.ofSeq(b$));b_[0]=cb;return cc;},b9);};K.Get=function(b7,b8){var b9;function b_(){X.WhenRun(b8(),function(b$){if(!b9[0]){b9[0]=true;b7(b$);}},function(){if(!b9[0])b_();});}b9=[false];b_();};K.ConvertSeqNode=function(b7,b8){var b9,b_;b9=A.Create$1(b8);b_=b9.get_View();return{e:b7(b_),r:b9,w:b_};};K.Map3=function(b7,b8,b9,b_){return K.CreateLazy(function(){return X.Map3(b7,b8(),b9(),b_());});};K.Sequence=function(b7){return K.CreateLazy(function(){return X.Sequence(O.map(function(b8){return b8();},b7));});};L.footertemplate=function(b7){return b7?g.GetOrLoadTemplate("todoapp",{$:1,$0:"footertemplate"},function(){return b4.parseHTML("<footer class=\"footer\">\n            <span class=\"todo-count\">\n                <strong>${Remaining}</strong>\n                ${RemainingLabel} left\n            </span>\n            <ul class=\"filters\" ws-hole=\"Filters\"></ul>\n            <span ws-replace=\"ClearCompleted\"></span>\n        </footer>");},b7):g.PrepareTemplate("todoapp",{$:1,$0:"footertemplate"},function(){return b4.parseHTML("<footer class=\"footer\">\n            <span class=\"todo-count\">\n                <strong>${Remaining}</strong>\n                ${RemainingLabel} left\n            </span>\n            <ul class=\"filters\" ws-hole=\"Filters\"></ul>\n            <span ws-replace=\"ClearCompleted\"></span>\n        </footer>");});};L.t=function(b7){return b7?g.GetOrLoadTemplate("todoapp",null,function(){return b4.parseHTML("<section class=\"todoapp\" ws-chidlren-template=\"TodoApp\">\n    <header class=\"header\">\n        <h1>todos</h1>\n        <input class=\"new-todo\" ws-var=\"NewTask\" ws-onkeyup=\"Add\" placeholder=\"What needs to be done?\" autofocus=\"\">\n    </header>\n    <section class=\"main\">\n        <span ws-replace=\"ToggleAll\"></span>\n        <label for=\"toggle-all\">Mark all as complete</label>\n        <ul class=\"todo-list\" ws-hole=\"TodoList\">\n            \n        </ul>\n    </section>\n    <div ws-replace=\"Footer\">\n        \n    </div>\n</section>\n<footer class=\"info\">\n    <p>Double-click to edit a todo</p>\n    <p>Written by <a href=\"https://github.com/SimonJF\">Simon Fowler</a> and <a href=\"https://github.com/qwe2\">István Gansperger</a></p>\n</footer>\n\n");},b7):g.PrepareTemplate("todoapp",null,function(){return b4.parseHTML("<section class=\"todoapp\" ws-chidlren-template=\"TodoApp\">\n    <header class=\"header\">\n        <h1>todos</h1>\n        <input class=\"new-todo\" ws-var=\"NewTask\" ws-onkeyup=\"Add\" placeholder=\"What needs to be done?\" autofocus=\"\">\n    </header>\n    <section class=\"main\">\n        <span ws-replace=\"ToggleAll\"></span>\n        <label for=\"toggle-all\">Mark all as complete</label>\n        <ul class=\"todo-list\" ws-hole=\"TodoList\">\n            \n        </ul>\n    </section>\n    <div ws-replace=\"Footer\">\n        \n    </div>\n</section>\n<footer class=\"info\">\n    <p>Double-click to edit a todo</p>\n    <p>Written by <a href=\"https://github.com/SimonJF\">Simon Fowler</a> and <a href=\"https://github.com/qwe2\">István Gansperger</a></p>\n</footer>\n\n");});};L.listitem=function(b7){return b7?g.GetOrLoadTemplate("todoapp",{$:1,$0:"listitem"},function(){return b4.parseHTML("<li class=\"${ItemState}\">\n                <div class=\"view\">\n                    <input class=\"toggle\" ws-var=\"Checked\" type=\"checkbox\">\n                    <label ws-ondblclick=\"Edit\">${Title}</label>\n                    <button class=\"destroy\" ws-onclick=\"Destroy\"></button>\n                </div>\n                <div ws-replace=\"TitleEditing\"></div>\n            </li>");},b7):g.PrepareTemplate("todoapp",{$:1,$0:"listitem"},function(){return b4.parseHTML("<li class=\"${ItemState}\">\n                <div class=\"view\">\n                    <input class=\"toggle\" ws-var=\"Checked\" type=\"checkbox\">\n                    <label ws-ondblclick=\"Edit\">${Title}</label>\n                    <button class=\"destroy\" ws-onclick=\"Destroy\"></button>\n                </div>\n                <div ws-replace=\"TitleEditing\"></div>\n            </li>");});};y=e.ListModel=b2.Class({UpdateAll:function(b7){var b8;b8=this;this["var"].Update(function(b9){H.iteri(function(b_,b$){var ca;ca=b7(b$);return ca==null?null:H.set(b9,b_,ca.$0);},b9);return b8.storage.SSet(b9);});this.ObsoleteAll();},TryFind:function(b7){return H.tryFind(b7,this["var"].Get());},RemoveBy:function(b7){var b8,b9,b_,b$;b8=this["var"].Get();for(b9=0,b_=b8.length-1;b9<=b_;b9++){b$=H.get(b8,b9);b7(b$)?this.ObsoleteKey(this.key(b$)):void 0;}this["var"].Set(this.storage.SRemoveIf(b7,this["var"].Get()));},Append:function(b7){var b8,b9,b_,b$;b8=this;b9=this["var"].Get();b_=this.key(b7);b$=H.tryFindIndex(function(ca){return t.Equals(b8.key(ca),b_);},b9);b$!=null&&b$.$==1?this["var"].Set(this.storage.SSetAt(b$.$0,b7,b9)):this["var"].Set(this.storage.SAppend(b7,b9));this.ObsoleteKey(b_);},RemoveByKey:function(b7){var b8;b8=this;this["var"].Set(this.storage.SRemoveIf(function(b9){return t.Equals(b8.key(b9),b7);},this["var"].Get()));this.ObsoleteKey(b7);},ObsoleteAll:function(){O.iter(function(b7){X.Obsolete(b7.V);},this.it);this.it.Clear();},ObsoleteKey:function(b7){var b8,b9;b8=(b9=null,[this.it.TryGetValue(b7,{get:function(){return b9;},set:function(b_){b9=b_;}}),b9]);b8[0]?(X.Obsolete(b8[1]),this.it.Remove(b7)):void 0;},MapLens:function(b7){var b8;b8=this;return K.MapSeqCachedViewBy(b8.key,function(b9,b_){return b7(b9,b8["LensInto'"](a.id,function(b$,ca){return ca;},b9,b_));},this["var"].get_View());},"LensInto'":function(b7,b8,b9,b_){var b$,ca,cb;b$=this;ca=bl.Id();cb=new C({Get:function(){return b7(b$.FindByKey(b9));},Set:function(cc){return b$.UpdateBy(function(cd){return{$:1,$0:b8(cd,cc)};},b9);},SetFinal:function(cc){return this.Set(cc);},Update:function(cc){return b$.UpdateBy(function(cd){return{$:1,$0:b8(cd,cc(b7(cd)))};},b9);},UpdateMaybe:function(cc){return b$.UpdateBy(function(cd){var ce;ce=cc(b7(cd));return ce==null?null:{$:1,$0:b8(cd,ce.$0)};},b9);},get_View:function(){return b_;},get_Id:function(){return ca;}});C.New.call(cb);return cb;},FindByKey:function(b7){var b8;b8=this;return H.find(function(b9){return t.Equals(b8.key(b9),b7);},this["var"].Get());},UpdateBy:function(b7,b8){var b9,b_,b$,ca,cb;b9=this;b_=this["var"].Get();b$=H.tryFindIndex(function(cc){return t.Equals(b9.key(cc),b8);},b_);b$!=null&&b$.$==1?(ca=b$.$0,cb=b7(H.get(b_,ca)),cb!=null&&cb.$==1?(this["var"].Set(this.storage.SSetAt(ca,cb.$0,b_)),this.ObsoleteKey(b8)):void 0):void 0;},GetEnumerator:function(){return ba.Get(this["var"].Get());},GetEnumerator0:function(){return ba.Get0(this["var"].Get());}},h,y);y.New=b2.Ctor(function(b7,b8){y.New$3.call(this,b7,A.Create$1(H.ofSeq(O.distinctBy(b7,b8.SInit()))),b8);},y);y.New$3=b2.Ctor(function(b7,b8,b9){h.New.call(this);this.key=b7;this["var"]=b8;this.storage=b9;this.v=K.Map(function(b_){return b_.slice();},this["var"].get_View());this.it=new r.New$5();},y);M.$cctor=function(){M.$cctor=a.ignore;M.LoadedTemplates=new r.New$5();M.LocalTemplatesLoaded=false;M.TextHoleRE="\\${([^}]+)}";};N=q.HashSet=b2.Class({Add:function(b7){return this.add(b7);},Contains:function(b7){var b8;b8=this.data[this.hash(b7)];return b8==null?false:this.arrContains(b7,b8);},add:function(b7){var b8,b9;b8=this.hash(b7);b9=this.data[b8];return b9==null?(this.data[b8]=[b7],this.count=this.count+1,true):this.arrContains(b7,b9)?false:(b9.push(b7),this.count=this.count+1,true);},arrContains:function(b7,b8){var b9,b_,b$,ca;b9=true;b_=0;ca=b8.length;while(b9&&b_<ca)if(this.equals.apply(null,[b8[b_],b7]))b9=false;else b_=b_+1;return!b9;},ExceptWith:function(b7){var b8;b8=ba.Get(b7);try{while(b8.MoveNext())this.Remove(b8.Current());}finally{if(typeof b8=="object"&&"Dispose"in b8)b8.Dispose();}},get_Count:function(){return this.count;},CopyTo:function(b7){var b8,b9,b_,b$;b8=0;b9=bI.concat(this.data);for(b_=0,b$=b9.length-1;b_<=b$;b_++)H.set(b7,b_,b9[b_]);},IntersectWith:function(b7){var b8,b9,b_,b$,ca;b8=new N.New$4(b7,this.equals,this.hash);b9=bI.concat(this.data);for(b_=0,b$=b9.length-1;b_<=b$;b_++){ca=b9[b_];!b8.Contains(ca)?this.Remove(ca):void 0;}},Remove:function(b7){var b8;b8=this.data[this.hash(b7)];return b8==null?false:this.arrRemove(b7,b8)&&(this.count=this.count-1,true);},arrRemove:function(b7,b8){var b9,b_,b$,ca;b9=true;b_=0;ca=b8.length;while(b9&&b_<ca)if(this.equals.apply(null,[b8[b_],b7])){b8.splice.apply(b8,[b_,1]);b9=false;}else b_=b_+1;return!b9;},GetEnumerator:function(){return ba.Get(bI.concat(this.data));},GetEnumerator0:function(){return ba.Get(bI.concat(this.data));}},h,N);N.New$3=b2.Ctor(function(){N.New$4.call(this,[],t.Equals,t.Hash);},N);N.New$4=b2.Ctor(function(b7,b8,b9){var b_;h.New.call(this);this.equals=b8;this.hash=b9;this.data=[];this.count=0;b_=ba.Get(b7);try{while(b_.MoveNext())this.add(b_.Current());}finally{if(typeof b_=="object"&&"Dispose"in b_)b_.Dispose();}},N);N.New$2=b2.Ctor(function(b7){N.New$4.call(this,b7,t.Equals,t.Hash);},N);O.head=function(b7){var b8;b8=ba.Get(b7);try{return b8.MoveNext()?b8.Current():O.insufficient();}finally{if(typeof b8=="object"&&"Dispose"in b8)b8.Dispose();}};O.sumBy=function(b7,b8){return O.fold(function(b9,b_){return b9+b7(b_);},0,b8);};O.isEmpty=function(b7){var b8;b8=ba.Get(b7);try{return!b8.MoveNext();}finally{if(typeof b8=="object"&&"Dispose"in b8)b8.Dispose();}};O.append=function(b7,b8){return{GetEnumerator:function(){var b9,b_;b9=ba.Get(b7);b_=[true];return new bp.New(b9,null,function(b$){var ca;return b$.s.MoveNext()?(b$.c=b$.s.Current(),true):(ca=b$.s,!t.Equals(ca,null)?ca.Dispose():void 0,b$.s=null,b_[0]&&(b_[0]=false,b$.s=ba.Get(b8),b$.s.MoveNext()?(b$.c=b$.s.Current(),true):(b$.s.Dispose(),b$.s=null,false)));},function(b$){var ca;ca=b$.s;!t.Equals(ca,null)?ca.Dispose():void 0;});}};};O.exists=function(b7,b8){var b9,b_;b9=ba.Get(b8);try{b_=false;while(!b_&&b9.MoveNext())b_=b7(b9.Current());return b_;}finally{if(typeof b9=="object"&&"Dispose"in b9)b9.Dispose();}};O.fold=function(b7,b8,b9){var b_,b$;b_=b8;b$=ba.Get(b9);try{while(b$.MoveNext())b_=b7(b_,b$.Current());return b_;}finally{if(typeof b$=="object"&&"Dispose"in b$)b$.Dispose();}};O.delay=function(b7){return{GetEnumerator:function(){return ba.Get(b7());}};};O.distinctBy=function(b7,b8){return{GetEnumerator:function(){var b9,b_;b9=ba.Get(b8);b_=new N.New$3();return new bp.New(null,null,function(b$){var ca,cb;if(b9.MoveNext()){ca=b9.Current();cb=b_.Add(b7(ca));while(!cb&&b9.MoveNext()){ca=b9.Current();cb=b_.Add(b7(ca));}return cb&&(b$.c=ca,true);}else return false;},function(){b9.Dispose();});}};};O.map=function(b7,b8){return{GetEnumerator:function(){var b9;b9=ba.Get(b8);return new bp.New(null,null,function(b_){return b9.MoveNext()&&(b_.c=b7(b9.Current()),true);},function(){b9.Dispose();});}};};O.iter=function(b7,b8){var b9;b9=ba.Get(b8);try{while(b9.MoveNext())b7(b9.Current());}finally{if(typeof b9=="object"&&"Dispose"in b9)b9.Dispose();}};O.collect=function(b7,b8){return O.concat(O.map(b7,b8));};O.forall2=function(b7,b8,b9){return!O.exists2(function(b_,b$){return!b7(b_,b$);},b8,b9);};O.concat=function(b7){return{GetEnumerator:function(){var b8;b8=ba.Get(b7);return new bp.New(null,null,function(b9){var b_;while(true){b_=b9.s;if(t.Equals(b_,null)){if(b8.MoveNext()){b9.s=ba.Get(b8.Current());b9=b9;}else{b8.Dispose();return false;}}else if(b_.MoveNext()){b9.c=b_.Current();return true;}else{b9.Dispose();b9.s=null;b9=b9;}}},function(b9){var b_;b_=b9.s;!t.Equals(b_,null)?b_.Dispose():void 0;!t.Equals(b8,null)?b8.Dispose():void 0;});}};};O.distinct=function(b7){return O.distinctBy(a.id,b7);};O.exists2=function(b7,b8,b9){var b_,b$,ca,cb;b_=ba.Get(b8);try{ca=ba.Get(b9);try{cb=false;while(!cb&&b_.MoveNext()&&ca.MoveNext())cb=b7(b_.Current(),ca.Current());b$=cb;}finally{if(typeof ca=="object"&&"Dispose"in ca)ca.Dispose();}return b$;}finally{if(typeof b_=="object"&&"Dispose"in b_)b_.Dispose();}};O.max=function(b7){var b8,b9,b_;b8=ba.Get(b7);try{if(!b8.MoveNext())O.seqEmpty();b9=b8.Current();while(b8.MoveNext()){b_=b8.Current();t.Compare(b_,b9)===1?b9=b_:void 0;}return b9;}finally{if(typeof b8=="object"&&"Dispose"in b8)b8.Dispose();}};O.seqEmpty=function(){return m.FailWith("The input sequence was empty.");};O.unfold=function(b7,b8){return{GetEnumerator:function(){return new bp.New(b8,null,function(b9){var b_;b_=b7(b9.s);return b_==null?false:(b9.c=b_.$0[0],b9.s=b_.$0[1],true);},void 0);}};};O.compareWith=function(b7,b8,b9){var b_,b$,ca,cb,cc;b_=ba.Get(b8);try{ca=ba.Get(b9);try{cb=0;cc=true;while(cc&&cb===0)if(b_.MoveNext())cb=ca.MoveNext()?b7(b_.Current(),ca.Current()):1;else if(ca.MoveNext())cb=-1;else cc=false;b$=cb;}finally{if(typeof ca=="object"&&"Dispose"in ca)ca.Dispose();}return b$;}finally{if(typeof b_=="object"&&"Dispose"in b_)b_.Dispose();}};O.forall=function(b7,b8){return!O.exists(function(b9){return!b7(b9);},b8);};K=e.View=b2.Class({},null,K);Q.$cctor=function(){Q.$cctor=a.ignore;Q.Doc=self.document;};R.LinkElement=function(b7,b8){R.InsertDoc(b7,b8,null);};R.InsertDoc=function(b7,b8,b9){var b_;return b8!=null&&b8.$==1?R.InsertNode(b7,b8.$0.El,b9):b8!=null&&b8.$==2?(b_=b8.$0,(b_.Dirty=false,R.InsertDoc(b7,b_.Current,b9))):b8==null?b9:b8!=null&&b8.$==4?R.InsertNode(b7,b8.$0.Text,b9):b8!=null&&b8.$==5?R.InsertNode(b7,b8.$0,b9):b8!=null&&b8.$==6?H.foldBack(function(b$,ca){return b$==null||b$.constructor===_9?R.InsertDoc(b7,b$,ca):R.InsertNode(b7,b$,ca);},b8.$0.Els,b9):R.InsertDoc(b7,b8.$0,R.InsertDoc(b7,b8.$1,b9));};R.CreateRunState=function(b7,b8){return bt.New(bu.get_Empty(),R.CreateElemNode(b7,_2.EmptyAttr(),b8));};R.PerformAnimatedUpdate=function(b7,b8,b9){var b_;return be.get_UseAnimations()?(b_=null,bC.Delay(function(){var b$,ca,cb;b$=bu.FindAll(b9);ca=R.ComputeChangeAnim(b8,b$);cb=R.ComputeEnterAnim(b8,b$);return bC.Bind(be.Play(be.Append(ca,R.ComputeExitAnim(b8,b$))),function(){return bC.Bind(R.SyncElemNodesNextFrame(b7,b8),function(){return bC.Bind(be.Play(cb),function(){b8.PreviousNodes=b$;return bC.Return(null);});});});})):R.SyncElemNodesNextFrame(b7,b8);};R.PerformSyncUpdate=function(b7,b8,b9){var b_;b_=bu.FindAll(b9);R.SyncElemNode(b7,b8.Top);b8.PreviousNodes=b_;};R.CreateEmbedNode=function(){return{Current:null,Dirty:false};};R.UpdateEmbedNode=function(b7,b8){b7.Current=b8;b7.Dirty=true;};R.InsertNode=function(b7,b8,b9){s.InsertAt(b7,b9,b8);return b8;};R.CreateElemNode=function(b7,b8,b9){var b_;R.LinkElement(b7,b9);b_=_2.Insert(b7,b8);return bc.New(b_,b9,null,b7,bl.Int(),b2.GetOptional(b_.OnAfterRender));};R.SyncElemNodesNextFrame=function(b7,b8){function b9(b_){a.requestAnimationFrame(function(){R.SyncElemNode(b7,b8.Top);b_();});}return bf.BatchUpdatesEnabled()?bC.FromContinuations(function(b_,b$,ca){return b9.apply(null,[b_,b$,ca]);}):(R.SyncElemNode(b7,b8.Top),bC.Return(null));};R.ComputeExitAnim=function(b7,b8){return be.Concat(H.map(function(b9){return _2.GetExitAnim(b9.Attr);},bu.ToArray(bu.Except(b8,bu.Filter(function(b9){return _2.HasExitAnim(b9.Attr);},b7.PreviousNodes)))));};R.ComputeEnterAnim=function(b7,b8){return be.Concat(H.map(function(b9){return _2.GetEnterAnim(b9.Attr);},bu.ToArray(bu.Except(b7.PreviousNodes,bu.Filter(function(b9){return _2.HasEnterAnim(b9.Attr);},b8)))));};R.ComputeChangeAnim=function(b7,b8){var b9;function b_(b$){return _2.HasChangeAnim(b$.Attr);}b9=function(b$){return bu.Filter(b_,b$);};return be.Concat(H.map(function(b$){return _2.GetChangeAnim(b$.Attr);},bu.ToArray(bu.Intersect(b9(b7.PreviousNodes),b9(b8)))));};R.SyncElemNode=function(b7,b8){!b7?R.SyncElement(b8):void 0;R.Sync(b8.Children);R.AfterRender(b8);};R.SyncElement=function(b7){function b8(b9){function b_(b$){var ca,cb;return b$!=null&&b$.$==0?b_(b$.$0)||b_(b$.$1):b$!=null&&b$.$==2?(ca=b$.$0,ca.Dirty||b_(ca.Current)):b$!=null&&b$.$==6&&(cb=b$.$0,cb.Dirty||H.exists(b8,cb.Holes));}return b_(b9.Children);}_2.Sync(b7.El,b7.Attr);b8(b7)?R.DoSyncElement(b7):void 0;};R.Sync=function(b7){var b8,b9;if(b7!=null&&b7.$==1)R.SyncElemNode(false,b7.$0);else if(b7!=null&&b7.$==2)R.Sync(b7.$0.Current);else if(b7==null);else if(b7!=null&&b7.$==5);else if(b7!=null&&b7.$==4){b8=b7.$0;b8.Dirty?(b8.Text.nodeValue=b8.Value,b8.Dirty=false):void 0;}else if(b7!=null&&b7.$==6){b9=b7.$0;H.iter(function(b_){R.SyncElemNode(false,b_);},b9.Holes);H.iter(function(b_){_2.Sync(b_[0],b_[1]);},b9.Attrs);R.AfterRender(b9);}else{R.Sync(b7.$0);R.Sync(b7.$1);}};R.AfterRender=function(b7){var b8;b8=b2.GetOptional(b7.Render);b8!=null&&b8.$==1?(b8.$0(b7.El),b2.SetOptional(b7,"Render",null)):void 0;};R.DoSyncElement=function(b7){var b8,b9,b_;function b$(ca,cb){var cc,cd;return ca!=null&&ca.$==1?ca.$0.El:ca!=null&&ca.$==2?(cc=ca.$0,cc.Dirty?(cc.Dirty=false,R.InsertDoc(b8,cc.Current,cb)):b$(cc.Current,cb)):ca==null?cb:ca!=null&&ca.$==4?ca.$0.Text:ca!=null&&ca.$==5?ca.$0:ca!=null&&ca.$==6?(cd=ca.$0,(cd.Dirty?cd.Dirty=false:void 0,H.foldBack(function(ce,cf){return ce==null||ce.constructor===_9?b$(ce,cf):ce;},cd.Els,cb))):b$(ca.$0,b$(ca.$1,cb));}b8=b7.El;bS.Iter((b9=b7.El,function(ca){s.RemoveNode(b9,ca);}),bS.Except(bS.DocChildren(b7),bS.Children(b7.El,b2.GetOptional(b7.Delimiters))));b$(b7.Children,(b_=b2.GetOptional(b7.Delimiters),b_!=null&&b_.$==1?b_.$0[1]:null));};R.InsertBeforeDelim=function(b7,b8){var b9,b_;b9=b7.parentNode;b_=self.document.createTextNode("");b9.insertBefore(b_,b7);R.LinkPrevElement(b7,b8);return b_;};R.CreateTextNode=function(){return{Text:s.CreateText(""),Dirty:false,Value:""};};R.UpdateTextNode=function(b7,b8){b7.Value=b8;b7.Dirty=true;};R.LinkPrevElement=function(b7,b8){R.InsertDoc(b7.parentNode,b8,b7);};S.OfArray=function(b7){return new bi.New$1(bD.OfSeq(O.map(function(b8){return bF.New(b8[0],b8[1]);},b7)));};T.InMemory=function(b7){return new bj.New(b7);};U.TryParseInt32=function(b7,b8){return U.TryParse(b7,-2147483648,2147483647,b8);};V.InstallMap=function(b7){var b8;function b9(cb,cc){return t.Equals(b7.Ser(cb),b7.Ser(cc));}function b_(){return b7.Des(bk.ToList(bk.ParseHash(self.location.hash)));}function b$(cb){if(!b9(b8.Get(),cb))b8.Set(cb);}function ca(cb){return b$(b_());}b8=A.Create$1(b_());self.onpopstate=ca;self.onhashchange=ca;K.Sink(function(cb){var cc,cd;cc=bk.MakeHash((cd=b7.Ser(cb),bk.FromList(cd[0],cd[1])));!bk.SameHash(self.location.hash,cc)?self.location.replace("#"+cc):void 0;},b8.get_View());return b8;};W=e.ConcreteVar=b2.Class({get_View:function(){return this.view;},Set:function(b7){if(this.isConst)(function(b8){return b8("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(b8){b3.log(b8);}));else{X.Obsolete(this.snap);this.current=b7;this.snap=X.New({$:2,$0:b7,$1:[]});}},Get:function(){return this.current;},Update:function(b7){this.Set(b7(this.Get()));},UpdateMaybe:function(b7){var b8;b8=b7(this.Get());b8!=null&&b8.$==1?this.Set(b8.$0):void 0;}},C,W);W.New=b2.Ctor(function(b7,b8,b9){var b_;b_=this;C.New.call(this);this.isConst=b7;this.current=b9;this.snap=b8;this.view=function(){return b_.snap;};this.id=bl.Int();},W);X.Map=function(b7,b8){var b9,b_;b9=b8.s;return b9!=null&&b9.$==0?X.New({$:0,$0:b7(b9.$0)}):(b_=X.New({$:3,$0:[],$1:[]}),(X.When(b8,function(b$){X.MarkDone(b_,b8,b7(b$));},b_),b_));};X.WhenObsoleteRun=function(b7,b8){var b9;b9=b7.s;b9==null?b8():b9!=null&&b9.$==2?b9.$1.push(b8):b9!=null&&b9.$==3?b9.$1.push(b8):void 0;};X.When=function(b7,b8,b9){var b_;b_=b7.s;b_==null?X.Obsolete(b9):b_!=null&&b_.$==2?(X.EnqueueSafe(b_.$1,b9),b8(b_.$0)):b_!=null&&b_.$==3?(b_.$0.push(b8),X.EnqueueSafe(b_.$1,b9)):b8(b_.$0);};X.MarkDone=function(b7,b8,b9){var b_;if(b_=b8.s,b_!=null&&b_.$==0)X.MarkForever(b7,b9);else X.MarkReady(b7,b9);};X.WhenRun=function(b7,b8,b9){var b_;b_=b7.s;b_==null?b9():b_!=null&&b_.$==2?(b_.$1.push(b9),b8(b_.$0)):b_!=null&&b_.$==3?(b_.$0.push(b8),b_.$1.push(b9)):b8(b_.$0);};X.Map2=function(b7,b8,b9){var b_,b$,ca;function cb(cc){var cd,ce,cf;if(!(cd=ca.s,cd!=null&&cd.$==0||cd!=null&&cd.$==2)){ce=X.ValueAndForever(b8);cf=X.ValueAndForever(b9);ce!=null&&ce.$==1?cf!=null&&cf.$==1?ce.$0[1]&&cf.$0[1]?X.MarkForever(ca,b7(ce.$0[0],cf.$0[0])):X.MarkReady(ca,b7(ce.$0[0],cf.$0[0])):void 0:void 0;}}b_=b8.s;b$=b9.s;return b_!=null&&b_.$==0?b$!=null&&b$.$==0?X.New({$:0,$0:b7(b_.$0,b$.$0)}):X.Map2Opt1(b7,b_.$0,b9):b$!=null&&b$.$==0?X.Map2Opt2(b7,b$.$0,b8):(ca=X.New({$:3,$0:[],$1:[]}),(X.When(b8,cb,ca),X.When(b9,cb,ca),ca));};X.EnqueueSafe=function(b7,b8){var b9,b_,b$,ca;b7.push(b8);if(b7.length%20===0){b9=b7.slice(0);bP.Clear(b7);for(b_=0,b$=H.length(b9)-1;b_<=b$;b_++){ca=H.get(b9,b_);typeof ca=="object"?function(cb){if(cb.s)b7.push(cb);}(ca):function(cb){b7.push(cb);}(ca);}}else void 0;};X.MarkForever=function(b7,b8){var b9,b_,b$,ca;b9=b7.s;if(b9!=null&&b9.$==3){b7.s={$:0,$0:b8};b_=b9.$0;for(b$=0,ca=H.length(b_)-1;b$<=ca;b$++)(H.get(b_,b$))(b8);}else void 0;};X.MarkReady=function(b7,b8){var b9,b_,b$,ca;b9=b7.s;if(b9!=null&&b9.$==3){b7.s={$:2,$0:b8,$1:b9.$1};b_=b9.$0;for(b$=0,ca=H.length(b_)-1;b$<=ca;b$++)(H.get(b_,b$))(b8);}else void 0;};X.Map2Unit=function(b7,b8){var b9,b_,b$;function ca(){var cb,cc,cd;if(!(cb=b$.s,cb!=null&&cb.$==0||cb!=null&&cb.$==2)){cc=X.ValueAndForever(b7);cd=X.ValueAndForever(b8);cc!=null&&cc.$==1?cd!=null&&cd.$==1?cc.$0[1]&&cd.$0[1]?X.MarkForever(b$,null):X.MarkReady(b$,null):void 0:void 0;}}b9=b7.s;b_=b8.s;return b9!=null&&b9.$==0?b_!=null&&b_.$==0?X.New({$:0,$0:null}):b8:b_!=null&&b_.$==0?b7:(b$=X.New({$:3,$0:[],$1:[]}),(X.When(b7,ca,b$),X.When(b8,ca,b$),b$));};X.Map2Opt1=function(b7,b8,b9){return X.Map(function(b_){return b7(b8,b_);},b9);};X.Map2Opt2=function(b7,b8,b9){return X.Map(function(b_){return b7(b_,b8);},b9);};X.ValueAndForever=function(b7){var b8;b8=b7.s;return b8!=null&&b8.$==0?{$:1,$0:[b8.$0,true]}:b8!=null&&b8.$==2?{$:1,$0:[b8.$0,false]}:null;};X.Join=function(b7){var b8;b8=X.New({$:3,$0:[],$1:[]});X.When(b7,function(b9){var b_;b_=b9();X.When(b_,function(b$){var ca,cb;if((ca=b_.s,ca!=null&&ca.$==0)&&(cb=b7.s,cb!=null&&cb.$==0))X.MarkForever(b8,b$);else X.MarkReady(b8,b$);},b8);},b8);return b8;};X.Copy=function(b7){var b8,b9,b_;b8=b7.s;return b8==null?b7:b8!=null&&b8.$==2?(b9=X.New({$:2,$0:b8.$0,$1:[]}),(X.WhenObsolete(b7,b9),b9)):b8!=null&&b8.$==3?(b_=X.New({$:3,$0:[],$1:[]}),(X.When(b7,function(b$){X.MarkDone(b_,b7,b$);},b_),b_)):b7;};X.WhenObsolete=function(b7,b8){var b9;b9=b7.s;b9==null?X.Obsolete(b8):b9!=null&&b9.$==2?X.EnqueueSafe(b9.$1,b8):b9!=null&&b9.$==3?X.EnqueueSafe(b9.$1,b8):void 0;};X.Map3=function(b7,b8,b9,b_){var b$,ca,cb,cc;function cd(ce){var cf,cg,ch,ci;if(!(cf=cc.s,cf!=null&&cf.$==0||cf!=null&&cf.$==2)){cg=X.ValueAndForever(b8);ch=X.ValueAndForever(b9);ci=X.ValueAndForever(b_);cg!=null&&cg.$==1?ch!=null&&ch.$==1?ci!=null&&ci.$==1?cg.$0[1]&&ch.$0[1]&&ci.$0[1]?X.MarkForever(cc,b7(cg.$0[0],ch.$0[0],ci.$0[0])):X.MarkReady(cc,b7(cg.$0[0],ch.$0[0],ci.$0[0])):void 0:void 0:void 0;}}b$=b8.s;ca=b9.s;cb=b_.s;return b$!=null&&b$.$==0?ca!=null&&ca.$==0?cb!=null&&cb.$==0?X.New({$:0,$0:b7(b$.$0,ca.$0,cb.$0)}):X.Map3Opt1(b7,b$.$0,ca.$0,b_):cb!=null&&cb.$==0?X.Map3Opt2(b7,b$.$0,cb.$0,b9):X.Map3Opt3(b7,b$.$0,b9,b_):ca!=null&&ca.$==0?cb!=null&&cb.$==0?X.Map3Opt4(b7,ca.$0,cb.$0,b8):X.Map3Opt5(b7,ca.$0,b8,b_):cb!=null&&cb.$==0?X.Map3Opt6(b7,cb.$0,b8,b9):(cc=X.New({$:3,$0:[],$1:[]}),(X.When(b8,cd,cc),X.When(b9,cd,cc),X.When(b_,cd,cc),cc));};X.Sequence=function(b7){var b8,b9,b_;function b$(ca){var cb;if(b_[0]===0){cb=H.map(function(cc){var cd;cd=cc.s;return cd!=null&&cd.$==0?cd.$0:cd!=null&&cd.$==2?cd.$0:m.FailWith("value not found by View.Sequence");},b8);H.forall(function(cc){var cd;cd=cc.s;return cd!=null&&cd.$==0;},b8)?X.MarkForever(b9,cb):X.MarkReady(b9,cb);}else b_[0]--;}b8=H.ofSeq(b7);return b8.length==0?X.New({$:0,$0:[]}):(b9=X.New({$:3,$0:[],$1:[]}),(b_=[H.length(b8)-1],(H.iter(function(ca){X.When(ca,b$,b9);},b8),b9)));};X.Map3Opt1=function(b7,b8,b9,b_){return X.Map(function(b$){return b7(b8,b9,b$);},b_);};X.Map3Opt2=function(b7,b8,b9,b_){return X.Map(function(b$){return b7(b8,b$,b9);},b_);};X.Map3Opt3=function(b7,b8,b9,b_){return X.Map2(function(b$,ca){return b7(b8,b$,ca);},b9,b_);};X.Map3Opt4=function(b7,b8,b9,b_){return X.Map(function(b$){return b7(b$,b8,b9);},b_);};X.Map3Opt5=function(b7,b8,b9,b_){return X.Map2(function(b$,ca){return b7(b$,b8,ca);},b9,b_);};X.Map3Opt6=function(b7,b8,b9,b_){return X.Map2(function(b$,ca){return b7(b$,ca,b8);},b9,b_);};Y=q.List=b2.Class({GetEnumerator:function(){return ba.Get(this);},GetEnumerator0:function(){return ba.Get0(this);}},null,Y);_0.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(b7){var b8,b9;b8=b5.random()*16|0;b9=b7=="x"?b8:b8&3|8;return b9.toString(16);});};_1=e.AttrProxy=b2.Class({},null,_1);_1.Create=function(b7,b8){return _2.Static(function(b9){s.SetAttr(b9,b7,b8);});};_1.Concat=function(b7){var b8;b8=_3.ofSeqNonCopying(b7);return _3.TreeReduce(_2.EmptyAttr(),_1.Append,b8);};_1.Append=function(b7,b8){return _2.AppendTree(b7,b8);};_1.Handler=function(b7,b8){return _1.HandlerImpl(b7,b8);};_1.HandlerImpl=function(b7,b8){return _2.Static(function(b9){b9.addEventListener(b7,function(b_){return(b8(b9))(b_);},false);});};_2.Static=function(b7){return new _1({$:3,$0:b7});};_2.Dynamic=function(b7,b8){return new _1({$:1,$0:new bz.New(b7,b8)});};_2.AppendTree=function(b7,b8){var b9;return b7===null?b8:b8===null?b7:(b9=new _1({$:2,$0:b7,$1:b8}),(_2.SetFlags(b9,_2.Flags(b7)|_2.Flags(b8)),b9));};_2.Insert=function(b7,b8){var b9,b_,b$;function ca(cb){if(!(cb===null))if(cb!=null&&cb.$==1)b9.push(cb.$0);else if(cb!=null&&cb.$==2){ca(cb.$0);ca(cb.$1);}else if(cb!=null&&cb.$==3)cb.$0(b7);else if(cb!=null&&cb.$==4)b_.push(cb.$0);}b9=[];b_=[];ca(b8);b$=b9.slice(0);return br.New(b7,_2.Flags(b8),b$,b_.length===0?null:{$:1,$0:function(cb){O.iter(function(cc){cc(cb);},b_);}});};_2.EmptyAttr=function(){bJ.$cctor();return bJ.EmptyAttr;};_2.HasExitAnim=function(b7){var b8;b8=2;return(b7.DynFlags&b8)===b8;};_2.GetExitAnim=function(b7){return _2.GetAnim(b7,function(b8,b9){return b8.NGetExitAnim(b9);});};_2.HasEnterAnim=function(b7){var b8;b8=1;return(b7.DynFlags&b8)===b8;};_2.GetEnterAnim=function(b7){return _2.GetAnim(b7,function(b8,b9){return b8.NGetEnterAnim(b9);});};_2.HasChangeAnim=function(b7){var b8;b8=4;return(b7.DynFlags&b8)===b8;};_2.GetChangeAnim=function(b7){return _2.GetAnim(b7,function(b8,b9){return b8.NGetChangeAnim(b9);});};_2.Updates=function(b7){return _3.MapTreeReduce(function(b8){return b8.NChanged();},K.Const(),K.Map2Unit,b7.DynNodes);};_2.SetFlags=function(b7,b8){b7.flags=b8;};_2.Flags=function(b7){return b7!==null&&b7.hasOwnProperty("flags")?b7.flags:0;};_2.GetAnim=function(b7,b8){return be.Concat(H.map(function(b9){return b8(b9,b7.DynElem);},b7.DynNodes));};_2.Sync=function(b7,b8){H.iter(function(b9){b9.NSync(b7);},b8.DynNodes);};_2.Empty=function(b7){return br.New(b7,0,[],null);};_3.ofSeqNonCopying=function(b7){var b8,b9;if(b7 instanceof a.Array)return b7;else if(b7 instanceof x)return H.ofList(b7);else if(b7===null)return[];else{b8=[];b9=ba.Get(b7);try{while(b9.MoveNext())b8.push(b9.Current());return b8;}finally{if(typeof b9=="object"&&"Dispose"in b9)b9.Dispose();}}};_3.TreeReduce=function(b7,b8,b9){var b_;function b$(ca,cb){var cc,cd;return cb<=0?b7:cb===1&&(ca>=0&&ca<b_)?H.get(b9,ca):(cd=cb/2>>0,b8(b$(ca,cd),b$(ca+cd,cb-cd)));}b_=H.length(b9);return b$(0,b_);};_3.mapInPlace=function(b7,b8){var b9,b_;for(b9=0,b_=b8.length-1;b9<=b_;b9++)b8[b9]=b7(b8[b9]);return b8;};_3.MapTreeReduce=function(b7,b8,b9,b_){var b$;function ca(cb,cc){var cd,ce;return cc<=0?b8:cc===1&&(cb>=0&&cb<b$)?b7(H.get(b_,cb)):(ce=cc/2>>0,b9(ca(cb,ce),ca(cb+ce,cc-ce)));}b$=H.length(b_);return ca(0,b$);};_4.Box=a.id;H.choose=function(b7,b8){var b9,b_,b$,ca;b9=[];for(b_=0,b$=b8.length-1;b_<=b$;b_++){ca=b7(b8[b_]);ca==null?void 0:b9.push(ca.$0);}return b9;};H.exists=function(b7,b8){var b9,b_,b$,ca;b9=false;b_=0;ca=H.length(b8);while(!b9&&b_<ca)if(b7(b8[b_]))b9=true;else b_=b_+1;return b9;};H.tryPick=function(b7,b8){var b9,b_,b$;b9=null;b_=0;while(b_<b8.length&&b9==null){b$=b7(b8[b_]);b$!=null&&b$.$==1?b9=b$:void 0;b_=b_+1;}return b9;};H.tryFindIndex=function(b7,b8){var b9,b_;b9=null;b_=0;while(b_<b8.length&&b9==null){b7(b8[b_])?b9={$:1,$0:b_}:void 0;b_=b_+1;}return b9;};H.ofSeq=function(b7){var b8,b9;if(b7 instanceof a.Array)return b7.slice();else if(b7 instanceof x)return H.ofList(b7);else{b8=[];b9=ba.Get(b7);try{while(b9.MoveNext())b8.push(b9.Current());return b8;}finally{if(typeof b9=="object"&&"Dispose"in b9)b9.Dispose();}}};H.iteri=function(b7,b8){var b9,b_;for(b9=0,b_=b8.length-1;b9<=b_;b9++)b7(b9,b8[b9]);};H.tryFind=function(b7,b8){var b9,b_;b9=null;b_=0;while(b_<b8.length&&b9==null){b7(b8[b_])?b9={$:1,$0:b8[b_]}:void 0;b_=b_+1;}return b9;};H.ofList=function(b7){var b8,b9;b9=[];b8=b7;while(!(b8.$==0)){b9.push(w.head(b8));b8=w.tail(b8);}return b9;};H.filter=function(b7,b8){var b9,b_,b$;b9=[];for(b_=0,b$=b8.length-1;b_<=b$;b_++)if(b7(b8[b_]))b9.push(b8[b_]);return b9;};H.map=function(b7,b8){var b9,b_,b$;b9=new a.Array(b8.length);for(b_=0,b$=b8.length-1;b_<=b$;b_++)b9[b_]=b7(b8[b_]);return b9;};H.iter=function(b7,b8){var b9,b_;for(b9=0,b_=b8.length-1;b9<=b_;b9++)b7(b8[b9]);};H.foldBack=function(b7,b8,b9){var b_,b$,ca,cb,cc;b_=b9;ca=b8.length;for(cb=1,cc=ca;cb<=cc;cb++)b_=b7(b8[ca-cb],b_);return b_;};H.concat=function(b7){return a.Array.prototype.concat.apply([],H.ofSeq(b7));};H.pick=function(b7,b8){var b9;b9=H.tryPick(b7,b8);return b9==null?m.FailWith("KeyNotFoundException"):b9.$0;};H.sortInPlace=function(b7){H.mapInPlace(function(b8){return b8[0];},H.mapiInPlace(function(b8,b9){return[b9,b8];},b7).sort(t.Compare));};H.create=function(b7,b8){var b9,b_,b$;b9=new a.Array(b7);for(b_=0,b$=b7-1;b_<=b$;b_++)b9[b_]=b8;return b9;};H.find=function(b7,b8){var b9;b9=H.tryFind(b7,b8);return b9==null?m.FailWith("KeyNotFoundException"):b9.$0;};H.init=function(b7,b8){var b9,b_,b$;b7<0?m.FailWith("Negative size given."):null;b9=new a.Array(b7);for(b_=0,b$=b7-1;b_<=b$;b_++)b9[b_]=b8(b_);return b9;};H.forall=function(b7,b8){var b9,b_,b$,ca;b9=true;b_=0;ca=H.length(b8);while(b9&&b_<ca)if(b7(b8[b_]))b_=b_+1;else b9=false;return b9;};_7.Trim=function(b7){return b7.replace(new a.RegExp("^\\s+"),"").replace(new a.RegExp("\\s+$"),"");};_7.concat=function(b7,b8){return H.ofSeq(b8).join(b7);};_7.SplitChars=function(b7,b8,b9){return _7.Split(b7,new a.RegExp("["+_7.RegexEscape(b8.join(""))+"]"),b9);};_7.StartsWith=function(b7,b8){return b7.substring(0,b8.length)==b8;};_7.Split=function(b7,b8,b9){return b9===1?H.filter(function(b_){return b_!=="";},_7.SplitWith(b7,b8)):_7.SplitWith(b7,b8);};_7.RegexEscape=function(b7){return b7.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};_7.SplitWith=function(b7,b8){return b7.split(b8);};_7.forall=function(b7,b8){return O.forall(b7,_7.protect(b8));};_7.protect=function(b7){return b7===null?"":b7;};_8.notPresent=function(){return m.FailWith("The given key was not present in the dictionary.");};_.convertTextNode=function(b7){var b8,b9,b_,b$,ca,cb;b8=null;b9=0;b$=b7.textContent;ca=new a.RegExp(g.TextHoleRE(),"g");while(b8=ca.exec(b$),b8!==null){b7.parentNode.insertBefore(self.document.createTextNode($.string(b$,{$:1,$0:b9},{$:1,$0:ca.lastIndex-H.get(b8,0).length-1})),b7);b9=ca.lastIndex;cb=self.document.createElement("span");cb.setAttribute("ws-replace",H.get(b8,1).toLowerCase());b7.parentNode.insertBefore(cb,b7);}ca.lastIndex=0;b7.textContent=$.string(b$,{$:1,$0:b9},null);};_.failNotLoaded=function(b7){b3.warn("Instantiating non-loaded template",b7);};_.fillTextHole=function(b7,b8,b9){var b_;b_=b7.querySelector("[ws-replace]");return t.Equals(b_,null)?(b3.warn("Filling non-existent text hole",b9),null):(b_.parentNode.replaceChild(new a.Text(b8),b_),{$:1,$0:b_.getAttribute("ws-replace")});};_.removeHolesExcept=function(b7,b8){function b9(b_){s.IterSelector(b7,"["+b_+"]",function(b$){if(!b8.Contains(b$.getAttribute(b_)))b$.removeAttribute(b_);});}b9("ws-attr");b9("ws-onafterrender");b9("ws-var");s.IterSelector(b7,"[ws-hole]",function(b_){if(!b8.Contains(b_.getAttribute("ws-hole"))){b_.removeAttribute("ws-hole");while(b_.hasChildNodes())b_.removeChild(b_.lastChild);}});s.IterSelector(b7,"[ws-replace]",function(b_){if(!b8.Contains(b_.getAttribute("ws-replace")))b_.parentNode.removeChild(b_);});s.IterSelector(b7,"[ws-on]",function(b_){b_.setAttribute("ws-on",_7.concat(" ",H.filter(function(b$){return b8.Contains(H.get(_7.SplitChars(b$,[":"],1),1));},_7.SplitChars(b_.getAttribute("ws-on"),[" "],1))));});s.IterSelector(b7,"[ws-attr-holes]",function(b_){var b$,ca,cb,cc,cd;b$=_7.SplitChars(b_.getAttribute("ws-attr-holes"),[" "],1);for(ca=0,cb=b$.length-1;ca<=cb;ca++){cc=H.get(b$,ca);b_.setAttribute(cc,(cd=new a.RegExp(g.TextHoleRE(),"g"),b_.getAttribute(cc).replace(cd,function(ce,cf){return b8.Contains(cf)?ce:"";})));}});};_.fillInstanceAttrs=function(b7,b8){var b9,b_,b$,ca,cb;_.convertAttrs(b8);b9=b8.nodeName.toLowerCase();b_=b7.querySelector("[ws-attr="+b9+"]");if(t.Equals(b_,null))b3.warn("Filling non-existent attr hole",b9);else{b_.removeAttribute("ws-attr");for(b$=0,ca=b8.attributes.length-1;b$<=ca;b$++){cb=b8.attributes.item(b$);cb.name==="class"&&b_.hasAttribute("class")?b_.setAttribute("class",b_.getAttribute("class")+" "+cb.nodeValue):b_.setAttribute(cb.name,cb.nodeValue);}}};_.mapHoles=function(b7,b8){function b9(b_){s.IterSelector(b7,"["+b_+"]",function(b$){var ca,cb;ca=(cb=null,[b8.TryGetValue(b$.getAttribute(b_).toLowerCase(),{get:function(){return cb;},set:function(cc){cb=cc;}}),cb]);ca[0]?b$.setAttribute(b_,ca[1]):void 0;});}b9("ws-hole");b9("ws-replace");b9("ws-attr");b9("ws-onafterrender");b9("ws-var");s.IterSelector(b7,"[ws-on]",function(b_){b_.setAttribute("ws-on",_7.concat(" ",H.map(function(b$){var ca,cb,cc;ca=_7.SplitChars(b$,[":"],1);cb=(cc=null,[b8.TryGetValue(H.get(ca,1),{get:function(){return cc;},set:function(cd){cc=cd;}}),cc]);return cb[0]?H.get(ca,0)+":"+cb[1]:b$;},_7.SplitChars(b_.getAttribute("ws-on"),[" "],1))));});s.IterSelector(b7,"[ws-attr-holes]",function(b_){var b$,ca,cb;b$=_7.SplitChars(b_.getAttribute("ws-attr-holes"),[" "],1);for(ca=0,cb=b$.length-1;ca<=cb;ca++)(function(){var cc;function cd(ce,cf){var cg;cg=m.KeyValue(cf);return ce.replace(new a.RegExp("\\${"+cg[0]+"}","ig"),"${"+cg[1]+"}");}cc=H.get(b$,ca);return b_.setAttribute(cc,(((b2.Curried3(O.fold))(cd))(b_.getAttribute(cc)))(b8));}());});};_.fill=function(b7,b8,b9){while(true)if(b7.hasChildNodes())b9=b8.insertBefore(b7.lastChild,b9);else return null;};_.convertAttrs=function(b7){var b9,b_,b$,ca,cb,cc,cd,ce;function b8(cf){var cg;cg=b7.getAttribute(cf);cg===null?void 0:b7.setAttribute(cf,cg.toLowerCase());}b9=b7.attributes;b_=[];b$=[];ca=[];for(cb=0,cc=b9.length-1;cb<=cc;cb++){cd=b9.item(cb);_7.StartsWith(cd.nodeName,"ws-on")&&cd.nodeName!=="ws-onafterrender"&&cd.nodeName!=="ws-on"?(b_.push(cd.nodeName),b$.push($.string(cd.nodeName,{$:1,$0:"ws-on".length},null)+":"+cd.nodeValue.toLowerCase())):!_7.StartsWith(cd.nodeName,"ws-")&&(new a.RegExp(g.TextHoleRE())).test(cd.nodeValue)?(cd.nodeValue=(ce=new a.RegExp(g.TextHoleRE(),"g"),cd.nodeValue.replace(ce,function(cf,cg){return"${"+cg.toLowerCase()+"}";})),ca.push(cd.nodeName)):void 0;}!(b$.length==0)?b7.setAttribute("ws-on",_7.concat(" ",b$)):void 0;!(ca.length==0)?b7.setAttribute("ws-attr-holes",_7.concat(" ",ca)):void 0;b8("ws-hole");b8("ws-replace");b8("ws-attr");b8("ws-onafterrender");b8("ws-var");H.iter(function(cf){b7.removeAttribute(cf);},b_);};$.string=function(b7,b8,b9){return b8==null?b9!=null&&b9.$==1?b7.slice(0,b9.$0+1):"":b9==null?b7.slice(b8.$0):b7.slice(b8.$0,b9.$0+1);};ba.Get=function(b7){return b7 instanceof a.Array?ba.ArrayEnumerator(b7):t.Equals(typeof b7,"string")?ba.StringEnumerator(b7):b7.GetEnumerator();};ba.ArrayEnumerator=function(b7){return new bp.New(0,null,function(b8){var b9;b9=b8.s;return b9<H.length(b7)&&(b8.c=H.get(b7,b9),b8.s=b9+1,true);},void 0);};ba.StringEnumerator=function(b7){return new bp.New(0,null,function(b8){var b9;b9=b8.s;return b9<b7.length&&(b8.c=b7[b9],b8.s=b9+1,true);},void 0);};ba.Get0=function(b7){return b7 instanceof a.Array?ba.ArrayEnumerator(b7):t.Equals(typeof b7,"string")?ba.StringEnumerator(b7):"GetEnumerator0"in b7?b7.GetEnumerator0():b7.GetEnumerator();};O.insufficient=function(){return m.FailWith("The input sequence has an insufficient number of elements.");};H.mapiInPlace=function(b7,b8){var b9,b_;for(b9=0,b_=b8.length-1;b9<=b_;b9++)b8[b9]=b7(b9,b8[b9]);return b8;};H.mapInPlace=function(b7,b8){var b9,b_;for(b9=0,b_=b8.length-1;b9<=b_;b9++)b8[b9]=b7(b8[b9]);};bb=q.KeyCollection=b2.Class({GetEnumerator$1:function(){return ba.Get(O.map(function(b7){return b7.K;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},h,bb);bb.New=b2.Ctor(function(b7){h.New.call(this);this.d=b7;},bb);bc=e.DocElemNode=b2.Class({Equals:function(b7){return this.ElKey===b7.ElKey;},GetHashCode:function(){return this.ElKey;}},null,bc);bc.New=function(b7,b8,b9,b_,b$,ca){var cb;return new bc((cb={Attr:b7,Children:b8,El:b_,ElKey:b$},(b2.SetOptional(cb,"Delimiters",b9),b2.SetOptional(cb,"Render",ca),cb)));};be.get_UseAnimations=function(){return bv.UseAnimations();};be.Play=function(b7){var b8;b8=null;return bC.Delay(function(){return bC.Bind(be.Run(a.ignore,bv.Actions(b7)),function(){bv.Finalize(b7);return bC.Return(null);});});};be.Append=function(b7,b8){return{$:0,$0:by.Append(b7.$0,b8.$0)};};be.Run=function(b7,b8){var b9;function b_(b$){function ca(cb,cc){var cd;cd=cc-cb;b8.Compute(cd);b7();return cd<=b9?void a.requestAnimationFrame(function(ce){ca(cb,ce);}):b$();}a.requestAnimationFrame(function(cb){ca(cb,cb);});}b9=b8.Duration;return b9===0?bC.Zero():bC.FromContinuations(function(b$,ca,cb){return b_.apply(null,[b$,ca,cb]);});};be.Concat=function(b7){return{$:0,$0:by.Concat(O.map(bv.List,b7))};};be.get_Empty=function(){return{$:0,$0:by.Empty()};};bf.BatchUpdatesEnabled=function(){bw.$cctor();return bw.BatchUpdatesEnabled;};bh.StartProcessor=function(b7){var b8;function b9(){var b_;b_=null;return bC.Delay(function(){return bC.Bind(b7,function(){var b$;b$=b8[0];return b$===1?(b8[0]=0,bC.Zero()):b$===2?(b8[0]=1,b9()):bC.Zero();});});}b8=[0];return function(){var b_;b_=b8[0];b_===0?(b8[0]=1,bC.Start(b9(),null)):b_===1?b8[0]=2:void 0;};};bi=q.FSharpMap=b2.Class({Equals:function(b7){return this.get_Count()===b7.get_Count()&&O.forall2(t.Equals,this,b7);},get_IsEmpty:function(){return this.tree==null;},GetEnumerator$1:function(){return ba.Get(O.map(function(b7){return{K:b7.Key,V:b7.Value};},bD.Enumerate(false,this.tree)));},get_Count:function(){var b7;b7=this.tree;return b7==null?0:b7.Count;},GetHashCode:function(){return t.Hash(H.ofSeq(this));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();},CompareTo0:function(b7){return O.compareWith(t.Compare,this,b7);}},h,bi);bi.New=b2.Ctor(function(b7){bi.New$1.call(this,bx.fromSeq(b7));},bi);bi.New$1=b2.Ctor(function(b7){h.New.call(this);this.tree=b7;},bi);bj=T.ArrayStorage=b2.Class({SSet:function(b7){return H.ofSeq(b7);},SRemoveIf:function(b7,b8){return H.filter(function(b9){return!b7(b9);},b8);},SSetAt:function(b7,b8,b9){H.set(b9,b7,b8);return b9;},SAppend:function(b7,b8){b8.push(b7);return b8;},SInit:function(){return this.init;}},h,bj);bj.New=b2.Ctor(function(b7){h.New.call(this);this.init=b7;},bj);bk.ParseHash=function(b7){var b8,b9,b_,b$;b8=bk.NoHash(b7);b9=(b_=b8.indexOf("?"),b_===-1?[b8,""]:[$.string(b8,null,{$:1,$0:b_-1}),$.string(b8,{$:1,$0:b_+1},null)]);b$=b9[0];return{$:0,$0:by.FromArray(b$===""?[]:H.map(function(ca){return a.decodeURIComponent(ca);},_7.SplitChars(b$,["/"],0))),$1:S.OfArray(H.map(function(ca){var cb;cb=ca.indexOf("=");return cb===-1?[a.decodeURIComponent(ca),""]:[a.decodeURIComponent($.string(ca,null,{$:1,$0:cb-1})),a.decodeURIComponent($.string(ca,{$:1,$0:cb+1},null))];},_7.SplitChars(b9[1],["&"],0)))};};bk.ToList=function(b7){return[w.ofArray(by.ToArray(b7.$0)),b7.$1];};bk.MakeHash=function(b7){var b8,b9;b8=b7.$1;b9=_7.concat("/",H.map(function(b_){return a.encodeURIComponent(b_);},by.ToArray(b7.$0)));return b8.get_IsEmpty()?b9:b9+"?"+_7.concat("&",O.map(function(b_){var b$;b$=m.KeyValue(b_);return a.encodeURIComponent(b$[0])+"="+a.encodeURIComponent(b$[1]);},b8));};bk.FromList=function(b7,b8){return{$:0,$0:by.FromArray(H.ofList(b7)),$1:b8};};bk.SameHash=function(b7,b8){return bk.NoHash(b7)===bk.NoHash(b8);};bk.NoHash=function(b7){return _7.StartsWith(b7,"#")?b7.substring(1):b7;};bl.Int=function(){bl.set_counter(bl.counter()+1);return bl.counter();};bl.set_counter=function(b7){bG.$cctor();bG.counter=b7;};bl.counter=function(){bG.$cctor();return bG.counter;};bl.Id=function(){bl.set_counter(bl.counter()+1);return"uid"+a.String(bl.counter());};bn=bm.attr=b2.Class({},h,bn);bo=e.CheckedInput=b2.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,bo);X.Obsolete=function(b7){var b8,b9,b_,b$,ca;b9=b7.s;if(b9==null||(b9!=null&&b9.$==2?(b8=b9.$1,false):b9!=null&&b9.$==3?(b8=b9.$1,false):true))void 0;else{b7.s=null;for(b_=0,b$=H.length(b8)-1;b_<=b$;b_++){ca=H.get(b8,b_);typeof ca=="object"?function(cb){X.Obsolete(cb);}(ca):ca();}}};X.New=function(b7){return{s:b7};};bp=ba.T=b2.Class({MoveNext:function(){return this.n(this);},Current:function(){return this.c;},Dispose:function(){if(this.d)this.d(this);}},h,bp);bp.New=b2.Ctor(function(b7,b8,b9,b_){h.New.call(this);this.s=b7;this.c=b8;this.n=b9;this.d=b_;},bp);br.New=function(b7,b8,b9,b_){var b$;b$={DynElem:b7,DynFlags:b8,DynNodes:b9};b2.SetOptional(b$,"OnAfterRender",b_);return b$;};bt.New=function(b7,b8){return{PreviousNodes:b7,Top:b8};};bu.get_Empty=function(){return{$:0,$0:new N.New$3()};};bu.FindAll=function(b7){var b8;function b9(b$){if(b$!=null&&b$.$==0){b9(b$.$0);b9(b$.$1);}else if(b$!=null&&b$.$==1)b_(b$.$0);else if(b$!=null&&b$.$==2)b9(b$.$0.Current);else if(b$!=null&&b$.$==6)H.iter(b_,b$.$0.Holes);}function b_(b$){b8.push(b$);b9(b$.Children);}b8=[];b9(b7);return{$:0,$0:new N.New$2(b8)};};bu.Filter=function(b7,b8){return{$:0,$0:bO.Filter(b7,b8.$0)};};bu.Except=function(b7,b8){return{$:0,$0:bO.Except(b7.$0,b8.$0)};};bu.ToArray=function(b7){return bO.ToArray(b7.$0);};bu.Intersect=function(b7,b8){return{$:0,$0:bO.Intersect(b7.$0,b8.$0)};};bv.UseAnimations=function(){bB.$cctor();return bB.UseAnimations;};bv.Actions=function(b7){return bv.ConcatActions(H.choose(function(b8){return b8.$==1?{$:1,$0:b8.$0}:null;},by.ToArray(b7.$0)));};bv.Finalize=function(b7){H.iter(function(b8){if(b8.$==0)b8.$0();},by.ToArray(b7.$0));};bv.ConcatActions=function(b7){var b8,b9,b_,b$;b8=_3.ofSeqNonCopying(b7);b9=H.length(b8);return b9===0?bv.Const():b9===1?H.get(b8,0):(b_=O.max(O.map(function(ca){return ca.Duration;},b8)),(b$=H.map(function(ca){return bv.Prolong(b_,ca);},b8),bv.Def(b_,function(ca){H.iter(function(cb){cb.Compute(ca);},b$);})));};bv.List=function(b7){return b7.$0;};bv.Const=function(b7){return bv.Def(0,function(){return b7;});};bv.Def=function(b7,b8){return{Compute:b8,Duration:b7};};bv.Prolong=function(b7,b8){var b9,b_,b$;b9=b8.Compute;b_=b8.Duration;b$=bV.Create(function(){return b8.Compute(b8.Duration);});return{Compute:function(ca){return ca>=b_?b$.f():b9(ca);},Duration:b7};};bw.$cctor=function(){bw.$cctor=a.ignore;bw.BatchUpdatesEnabled=true;};bx.fromSeq=function(b7){var b8;b8=H.ofSeq(O.delay(function(){return O.collect(function(b9){return[bF.New(b9[0],b9[1])];},O.distinctBy(function(b9){return b9[0];},b7));}));H.sortInPlace(b8);return bD.Build(b8,0,b8.length-1);};by.FromArray=function(b7){var b8;b8=b7.length;return b8===0?{$:0}:b8===1?{$:1,$0:H.get(b7,0)}:{$:3,$0:b7.slice()};};by.ToArray=function(b7){var b8;function b9(b_){if(b_.$==1)b8.push(b_.$0);else if(b_.$==2){b9(b_.$0);b9(b_.$1);}else if(b_.$==3)H.iter(function(b$){b8.push(b$);},b_.$0);}b8=[];b9(b7);return b8.slice(0);};by.Append=function(b7,b8){return b7.$==0?b8:b8.$==0?b7:{$:2,$0:b7,$1:b8};};by.Concat=function(b7){var b8;b8=_3.ofSeqNonCopying(b7);return _3.TreeReduce(by.Empty(),by.Append,b8);};by.Empty=function(){bW.$cctor();return bW.Empty;};bz=e.DynamicAttrNode=b2.Class({NGetExitAnim:function(b7){return be.get_Empty();},NGetEnterAnim:function(b7){return be.get_Empty();},NGetChangeAnim:function(b7){return be.get_Empty();},NChanged:function(){return this.updates;},NSync:function(b7){if(this.dirty){(this.push(b7))(this.value);this.dirty=false;}}},h,bz);bz.New=b2.Ctor(function(b7,b8){var b9;b9=this;h.New.call(this);this.push=b8;this.value=void 0;this.dirty=false;this.updates=K.Map(function(b_){b9.value=b_;b9.dirty=true;},b7);},bz);bA=e.Elt=b2.Class({},i,bA);bA.New=function(b7,b8,b9){var b_,b$;b_=R.CreateElemNode(b7,b8,b9.docNode);b$=bH.Create(b9.updates);return new bA.New$1({$:1,$0:b_},K.Map2Unit(_2.Updates(b_.Attr),b$.v),b7,b$);};bA.TreeNode=function(b7,b8){var b9,b_;function b$(ca){return ca[1];}b9=bH.Create(b8);return new bA.New$1({$:6,$0:b7},K.Map2Unit((b_=H.map(function(ca){return _2.Updates(b$(ca));},b7.Attrs),_3.TreeReduce(K.Const(),K.Map2Unit,b_)),b9.v),H.get(b7.Els,0),b9);};bA.New$1=b2.Ctor(function(b7,b8,b9,b_){i.New.call(this,b7,b8);this.docNode$1=b7;this.updates$1=b8;this.elt=b9;this.rvUpdates=b_;},bA);bB.$cctor=function(){bB.$cctor=a.ignore;bB.CubicInOut=bK.Custom(function(b7){var b8;b8=b7*b7;return 3*b8-2*(b8*b7);});bB.UseAnimations=true;};bC.Delay=function(b7){return function(b8){try{(b7(null))(b8);}catch(b9){b8.k({$:1,$0:b9});}};};bC.Bind=function(b7,b8){return bC.checkCancel(function(b9){b7(bL.New(function(b_){var b$;if(b_.$==0){b$=b_.$0;bC.scheduler().Fork(function(){try{(b8(b$))(b9);}catch(ca){b9.k({$:1,$0:ca});}});}else bC.scheduler().Fork(function(){b9.k(b_);});},b9.ct));});};bC.Zero=function(){bM.$cctor();return bM.Zero;};bC.Start=function(b7,b8){var b9,b_;b9=(b_=(bC.defCTS())[0],b8==null?b_:b8.$0);bC.scheduler().Fork(function(){if(!b9.c)b7(bL.New(function(b$){if(b$.$==1)bC.UncaughtAsyncError(b$.$0);},b9));});};bC.Return=function(b7){return function(b8){b8.k({$:0,$0:b7});};};bC.checkCancel=function(b7){return function(b8){if(b8.ct.c)bC.cancel(b8);else b7(b8);};};bC.defCTS=function(){bM.$cctor();return bM.defCTS;};bC.UncaughtAsyncError=function(b7){b3.log("WebSharper: Uncaught asynchronous exception",b7);};bC.FromContinuations=function(b7){return function(b8){var b9;function b_(b$){if(b9[0])m.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{b9[0]=true;bC.scheduler().Fork(b$);}}b9=[false];b7(function(b$){b_(function(){b8.k({$:0,$0:b$});});},function(b$){b_(function(){b8.k({$:1,$0:b$});});},function(b$){b_(function(){b8.k({$:2,$0:b$});});});};};bC.cancel=function(b7){b7.k({$:2,$0:new bU.New(b7.ct)});};bC.scheduler=function(){bM.$cctor();return bM.scheduler;};bE.New=function(b7,b8,b9,b_,b$){return{Node:b7,Left:b8,Right:b9,Height:b_,Count:b$};};bF=q.Pair=b2.Class({Equals:function(b7){return t.Equals(this.Key,b7.Key);},GetHashCode:function(){return t.Hash(this.Key);},CompareTo0:function(b7){return t.Compare(this.Key,b7.Key);}},null,bF);bF.New=function(b7,b8){return new bF({Key:b7,Value:b8});};bD.OfSeq=function(b7){var b8;b8=H.ofSeq(O.distinct(b7));H.sortInPlace(b8);return bD.Build(b8,0,b8.length-1);};bD.Build=function(b7,b8,b9){var b_,b$,ca;return b9-b8+1<=0?null:(b_=(b8+b9)/2>>0,(b$=bD.Build(b7,b8,b_-1),(ca=bD.Build(b7,b_+1,b9),bD.Branch(H.get(b7,b_),b$,ca))));};bD.Branch=function(b7,b8,b9){var b_,b$;return bE.New(b7,b8,b9,1+(b_=b8==null?0:b8.Height,(b$=b9==null?0:b9.Height,t.Compare(b_,b$)===1?b_:b$)),1+(b8==null?0:b8.Count)+(b9==null?0:b9.Count));};bD.Enumerate=function(b7,b8){function b9(b_,b$){var ca;while(true)if(b_==null)return b$.$==1?{$:1,$0:[b$.$0[0],[b$.$0[1],b$.$1]]}:null;else if(b7){ca=b_;b_=ca.Right;b$=new x({$:1,$0:[ca.Node,ca.Left],$1:b$});}else{ca=b_;b_=ca.Left;b$=new x({$:1,$0:[ca.Node,ca.Right],$1:b$});}}return O.unfold(function(b_){return b9(b_[0],b_[1]);},[b8,x.Empty]);};bG.$cctor=function(){bG.$cctor=a.ignore;bG.counter=0;};bH=e.Updates=b2.Class({},null,bH);bH.Create=function(b7){var b8;b8=null;b8=bH.New(b7,null,function(){var b9;b9=b8.s;return b9===null?(b9=X.Copy(b8.c()),b8.s=b9,X.WhenObsoleteRun(b9,function(){b8.s=null;}),b9):b9;});return b8;};bH.New=function(b7,b8,b9){return new bH({c:b7,s:b8,v:b9});};bI.concat=function(b7){var b8,b9;b8=[];for(var b_ in b7)b8.push.apply(b8,b7[b_]);return b8;};bJ.$cctor=function(){bJ.$cctor=a.ignore;bJ.EmptyAttr=null;};bK=e.Easing=b2.Class({},h,bK);bK.Custom=function(b7){return new bK.New(b7);};bK.New=b2.Ctor(function(b7){h.New.call(this);this.transformTime=b7;},bK);bL.New=function(b7,b8){return{k:b7,ct:b8};};bM.$cctor=function(){bM.$cctor=a.ignore;bM.noneCT=bN.New(false,[]);bM.scheduler=new bQ.New();bM.defCTS=[new bR.New()];bM.Zero=bC.Return();bM.GetCT=function(b7){b7.k({$:0,$0:b7.ct});};};bN.New=function(b7,b8){return{c:b7,r:b8};};bO.Filter=function(b7,b8){return new N.New$2(H.filter(b7,bO.ToArray(b8)));};bO.Except=function(b7,b8){var b9;b9=new N.New$2(bO.ToArray(b8));b9.ExceptWith(bO.ToArray(b7));return b9;};bO.ToArray=function(b7){var b8;b8=H.create(b7.get_Count(),void 0);b7.CopyTo(b8);return b8;};bO.Intersect=function(b7,b8){var b9;b9=new N.New$2(bO.ToArray(b7));b9.IntersectWith(bO.ToArray(b8));return b9;};bP.Clear=function(b7){b7.splice(0,H.length(b7));};bQ=bC.Scheduler=b2.Class({Fork:function(b7){var b8;b8=this;this.robin.push(b7);this.idle?(this.idle=false,a.setTimeout(function(){b8.tick();},0)):void 0;},tick:function(){var b7,b8,b9;b8=this;b9=b6.now();b7=true;while(b7)if(this.robin.length===0){this.idle=true;b7=false;}else{(this.robin.shift())();b6.now()-b9>40?(a.setTimeout(function(){b8.tick();},0),b7=false):void 0;}}},h,bQ);bQ.New=b2.Ctor(function(){h.New.call(this);this.idle=true;this.robin=[];},bQ);bR=d.CancellationTokenSource=b2.Class({},h,bR);bR.New=b2.Ctor(function(){h.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bR);bS.Children=function(b7,b8){var b9,b_,b$;if(b8!=null&&b8.$==1){b$=[];b9=b8.$0[0].nextSibling;while(b9!==b8.$0[1]){b$.push(b9);b9=b9.nextSibling;}return{$:0,$0:b$};}else return{$:0,$0:H.init(b7.childNodes.length,(b_=b7.childNodes,function(ca){return b_[ca];}))};};bS.Except=function(b7,b8){var b9;b9=b7.$0;return{$:0,$0:H.filter(function(b_){return H.forall(function(b$){return!(b_===b$);},b9);},b8.$0)};};bS.Iter=function(b7,b8){H.iter(b7,b8.$0);};bS.DocChildren=function(b7){var b8;function b9(b_){if(b_!=null&&b_.$==2)b9(b_.$0.Current);else if(b_!=null&&b_.$==1)b8.push(b_.$0.El);else if(b_==null);else if(b_!=null&&b_.$==5)b8.push(b_.$0);else if(b_!=null&&b_.$==4)b8.push(b_.$0.Text);else if(b_!=null&&b_.$==6)H.iter(function(b$){if(b$==null||b$.constructor===_9)b9(b$);else b8.push(b$);},b_.$0.Els);else{b9(b_.$0);b9(b_.$1);}}b8=[];b9(b7.Children);return{$:0,$0:_3.ofSeqNonCopying(b8)};};bU=d.OperationCanceledException=b2.Class({},bT,bU);bU.New=b2.Ctor(function(b7){bU.New$1.call(this,"The operation was canceled.",null,b7);},bU);bU.New$1=b2.Ctor(function(b7,b8,b9){this.message=b7;this.inner=b8;_9.setPrototypeOf(this,bU.prototype);this.ct=b9;},bU);bV.Create=function(b7){return bZ.New(false,b7,bV.forceLazy);};bV.forceLazy=function(){var b7;b7=this.v();this.c=true;this.v=b7;this.f=bV.cachedLazy;return b7;};bV.cachedLazy=function(){return this.v;};bW.$cctor=function(){bW.$cctor=a.ignore;bW.Empty={$:0};};bX.isBlank=function(b7){return _7.forall(b0.IsWhiteSpace,b7);};bZ.New=function(b7,b8,b9){return{c:b7,v:b8,f:b9};};b0.IsWhiteSpace=function(b7){return b7.match(new a.RegExp("\\s"))!==null;};U.TryParse=function(b7,b8,b9,b_){var b$,ca;b$=+b7;ca=b$===b$-b$%1&&b$>=b8&&b$<=b9;ca?b_.set(b$):void 0;return ca;};b2.OnLoad(function(){c.Main();});}());


if (typeof IntelliFactory !=='undefined') {
  IntelliFactory.Runtime.ScriptBasePath = '/Content/';
  IntelliFactory.Runtime.Start();
}
